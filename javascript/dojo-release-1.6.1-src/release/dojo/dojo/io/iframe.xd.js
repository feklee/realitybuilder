/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


realitybuilderDojo._xdResourceLoaded(function(_1,_2,_3){return {depends:[["provide","dojo.io.iframe"]],defineResource:function(_4,_5,_6){if(!_4._hasResource["dojo.io.iframe"]){_4._hasResource["dojo.io.iframe"]=true;_4.provide("dojo.io.iframe");_4.getObject("io",true,_4);_4.io.iframe={create:function(_7,_8,_9){if(window[_7]){return window[_7];}if(window.frames[_7]){return window.frames[_7];}var _a=null;var _b=_9;if(!_b){if(_4.config["useXDomain"]&&!_4.config["dojoBlankHtmlUrl"]){console.warn("dojo.io.iframe.create: When using cross-domain Dojo builds,"+" please save dojo/resources/blank.html to your domain and set djConfig.dojoBlankHtmlUrl"+" to the path on your domain to blank.html");}_b=(_4.config["dojoBlankHtmlUrl"]||_4.moduleUrl("dojo","resources/blank.html"));}var _a=_4.place("<iframe id=\""+_7+"\" name=\""+_7+"\" src=\""+_b+"\" onload=\""+_8+"\" style=\"position: absolute; left: 1px; top: 1px; height: 1px; width: 1px; visibility: hidden\">",_4.body());window[_7]=_a;return _a;},setSrc:function(_c,_d,_e){try{if(!_e){if(_4.isWebKit){_c.location=_d;}else{frames[_c.name].location=_d;}}else{var _f;if(_4.isIE||_4.isWebKit){_f=_c.contentWindow.document;}else{_f=_c.contentWindow;}if(!_f){_c.location=_d;return;}else{_f.location.replace(_d);}}}catch(e){console.log("dojo.io.iframe.setSrc: ",e);}},doc:function(_10){var doc=_10.contentDocument||(((_10.name)&&(_10.document)&&(_4.doc.getElementsByTagName("iframe")[_10.name].contentWindow)&&(_4.doc.getElementsByTagName("iframe")[_10.name].contentWindow.document)))||((_10.name)&&(_4.doc.frames[_10.name])&&(_4.doc.frames[_10.name].document))||null;return doc;},send:function(_11){if(!this["_frame"]){this._frame=this.create(this._iframeName,_4._scopeName+".io.iframe._iframeOnload();");}var dfd=_4._ioSetArgs(_11,function(dfd){dfd.canceled=true;dfd.ioArgs._callNext();},function(dfd){var _12=null;try{var _13=dfd.ioArgs;var dii=_4.io.iframe;var ifd=dii.doc(dii._frame);var _14=_13.handleAs;_12=ifd;if(_14!="html"){if(_14=="xml"){if(_4.isIE<9||(_4.isIE&&_4.isQuirks)){_4.query("a",dii._frame.contentWindow.document.documentElement).orphan();var _15=(dii._frame.contentWindow.document).documentElement.innerText;_15=_15.replace(/>\s+</g,"><");_15=_4.trim(_15);var _16={responseText:_15};_12=_4._contentHandlers["xml"](_16);}}else{_12=ifd.getElementsByTagName("textarea")[0].value;if(_14=="json"){_12=_4.fromJson(_12);}else{if(_14=="javascript"){_12=_4.eval(_12);}}}}}catch(e){_12=e;}finally{_13._callNext();}return _12;},function(_17,dfd){dfd.ioArgs._hasError=true;dfd.ioArgs._callNext();return _17;});dfd.ioArgs._callNext=function(){if(!this["_calledNext"]){this._calledNext=true;_4.io.iframe._currentDfd=null;_4.io.iframe._fireNextRequest();}};this._dfdQueue.push(dfd);this._fireNextRequest();_4._ioWatch(dfd,function(dfd){return !dfd.ioArgs["_hasError"];},function(dfd){return (!!dfd.ioArgs["_finished"]);},function(dfd){if(dfd.ioArgs._finished){dfd.callback(dfd);}else{dfd.errback(new Error("Invalid dojo.io.iframe request state"));}});return dfd;},_currentDfd:null,_dfdQueue:[],_iframeName:_4._scopeName+"IoIframe",_fireNextRequest:function(){try{if((this._currentDfd)||(this._dfdQueue.length==0)){return;}do{var dfd=this._currentDfd=this._dfdQueue.shift();}while(dfd&&dfd.canceled&&this._dfdQueue.length);if(!dfd||dfd.canceled){this._currentDfd=null;return;}var _18=dfd.ioArgs;var _19=_18.args;_18._contentToClean=[];var fn=_4.byId(_19["form"]);var _1a=_19["content"]||{};if(fn){if(_1a){var _1b=function(_1c,_1d){_4.create("input",{type:"hidden",name:_1c,value:_1d},fn);_18._contentToClean.push(_1c);};for(var x in _1a){var val=_1a[x];if(_4.isArray(val)&&val.length>1){var i;for(i=0;i<val.length;i++){_1b(x,val[i]);}}else{if(!fn[x]){_1b(x,val);}else{fn[x].value=val;}}}}var _1e=fn.getAttributeNode("action");var _1f=fn.getAttributeNode("method");var _20=fn.getAttributeNode("target");if(_19["url"]){_18._originalAction=_1e?_1e.value:null;if(_1e){_1e.value=_19.url;}else{fn.setAttribute("action",_19.url);}}if(!_1f||!_1f.value){if(_1f){_1f.value=(_19["method"])?_19["method"]:"post";}else{fn.setAttribute("method",(_19["method"])?_19["method"]:"post");}}_18._originalTarget=_20?_20.value:null;if(_20){_20.value=this._iframeName;}else{fn.setAttribute("target",this._iframeName);}fn.target=this._iframeName;_4._ioNotifyStart(dfd);fn.submit();}else{var _21=_19.url+(_19.url.indexOf("?")>-1?"&":"?")+_18.query;_4._ioNotifyStart(dfd);this.setSrc(this._frame,_21,true);}}catch(e){dfd.errback(e);}},_iframeOnload:function(){var dfd=this._currentDfd;if(!dfd){this._fireNextRequest();return;}var _22=dfd.ioArgs;var _23=_22.args;var _24=_4.byId(_23.form);if(_24){var _25=_22._contentToClean;for(var i=0;i<_25.length;i++){var key=_25[i];for(var j=0;j<_24.childNodes.length;j++){var _26=_24.childNodes[j];if(_26.name==key){_4.destroy(_26);break;}}}if(_22["_originalAction"]){_24.setAttribute("action",_22._originalAction);}if(_22["_originalTarget"]){_24.setAttribute("target",_22._originalTarget);_24.target=_22._originalTarget;}}_22._finished=true;}};}}};});