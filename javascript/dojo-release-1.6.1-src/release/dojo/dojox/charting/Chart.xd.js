/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


realityBuilderDojo._xdResourceLoaded(function(_1,_2,_3){return {depends:[["provide","dojox.charting.Chart"],["require","dojox.gfx"],["require","dojox.lang.functional"],["require","dojox.lang.functional.fold"],["require","dojox.lang.functional.reversed"],["require","dojox.charting.Element"],["require","dojox.charting.Theme"],["require","dojox.charting.Series"],["require","dojox.charting.axis2d.common"]],defineResource:function(_4,_5,_6){if(!_4._hasResource["dojox.charting.Chart"]){_4._hasResource["dojox.charting.Chart"]=true;_4.provide("dojox.charting.Chart");_4.require("dojox.gfx");_4.require("dojox.lang.functional");_4.require("dojox.lang.functional.fold");_4.require("dojox.lang.functional.reversed");_4.require("dojox.charting.Element");_4.require("dojox.charting.Theme");_4.require("dojox.charting.Series");_4.require("dojox.charting.axis2d.common");(function(){var df=_6.lang.functional,dc=_6.charting,g=_6.gfx,_7=df.lambda("item.clear()"),_8=df.lambda("item.purgeGroup()"),_9=df.lambda("item.destroy()"),_a=df.lambda("item.dirty = false"),_b=df.lambda("item.dirty = true"),_c=df.lambda("item.name");_4.declare("dojox.charting.Chart",null,{constructor:function(_d,_e){if(!_e){_e={};}this.margins=_e.margins?_e.margins:{l:10,t:10,r:10,b:10};this.stroke=_e.stroke;this.fill=_e.fill;this.delayInMs=_e.delayInMs||200;this.title=_e.title;this.titleGap=_e.titleGap;this.titlePos=_e.titlePos;this.titleFont=_e.titleFont;this.titleFontColor=_e.titleFontColor;this.chartTitle=null;this.theme=null;this.axes={};this.stack=[];this.plots={};this.series=[];this.runs={};this.dirty=true;this.coords=null;this.node=_4.byId(_d);var _f=_4.marginBox(_d);this.surface=g.createSurface(this.node,_f.w||400,_f.h||300);},destroy:function(){_4.forEach(this.series,_9);_4.forEach(this.stack,_9);df.forIn(this.axes,_9);if(this.chartTitle&&this.chartTitle.tagName){_4.destroy(this.chartTitle);}this.surface.destroy();},getCoords:function(){if(!this.coords){this.coords=_4.coords(this.node,true);}return this.coords;},setTheme:function(_10){this.theme=_10.clone();this.dirty=true;return this;},addAxis:function(_11,_12){var _13,_14=_12&&_12.type||"Default";if(typeof _14=="string"){if(!dc.axis2d||!dc.axis2d[_14]){throw Error("Can't find axis: "+_14+" - didn't you forget to dojo"+".require() it?");}_13=new dc.axis2d[_14](this,_12);}else{_13=new _14(this,_12);}_13.name=_11;_13.dirty=true;if(_11 in this.axes){this.axes[_11].destroy();}this.axes[_11]=_13;this.dirty=true;return this;},getAxis:function(_15){return this.axes[_15];},removeAxis:function(_16){if(_16 in this.axes){this.axes[_16].destroy();delete this.axes[_16];this.dirty=true;}return this;},addPlot:function(_17,_18){var _19,_1a=_18&&_18.type||"Default";if(typeof _1a=="string"){if(!dc.plot2d||!dc.plot2d[_1a]){throw Error("Can't find plot: "+_1a+" - didn't you forget to dojo"+".require() it?");}_19=new dc.plot2d[_1a](this,_18);}else{_19=new _1a(this,_18);}_19.name=_17;_19.dirty=true;if(_17 in this.plots){this.stack[this.plots[_17]].destroy();this.stack[this.plots[_17]]=_19;}else{this.plots[_17]=this.stack.length;this.stack.push(_19);}this.dirty=true;return this;},removePlot:function(_1b){if(_1b in this.plots){var _1c=this.plots[_1b];delete this.plots[_1b];this.stack[_1c].destroy();this.stack.splice(_1c,1);df.forIn(this.plots,function(idx,_1d,_1e){if(idx>_1c){_1e[_1d]=idx-1;}});var ns=_4.filter(this.series,function(run){return run.plot!=_1b;});if(ns.length<this.series.length){_4.forEach(this.series,function(run){if(run.plot==_1b){run.destroy();}});this.runs={};_4.forEach(ns,function(run,_1f){this.runs[run.plot]=_1f;},this);this.series=ns;}this.dirty=true;}return this;},getPlotOrder:function(){return df.map(this.stack,_c);},setPlotOrder:function(_20){var _21={},_22=df.filter(_20,function(_23){if(!(_23 in this.plots)||(_23 in _21)){return false;}_21[_23]=1;return true;},this);if(_22.length<this.stack.length){df.forEach(this.stack,function(_24){var _25=_24.name;if(!(_25 in _21)){_22.push(_25);}});}var _26=df.map(_22,function(_27){return this.stack[this.plots[_27]];},this);df.forEach(_26,function(_28,i){this.plots[_28.name]=i;},this);this.stack=_26;this.dirty=true;return this;},movePlotToFront:function(_29){if(_29 in this.plots){var _2a=this.plots[_29];if(_2a){var _2b=this.getPlotOrder();_2b.splice(_2a,1);_2b.unshift(_29);return this.setPlotOrder(_2b);}}return this;},movePlotToBack:function(_2c){if(_2c in this.plots){var _2d=this.plots[_2c];if(_2d<this.stack.length-1){var _2e=this.getPlotOrder();_2e.splice(_2d,1);_2e.push(_2c);return this.setPlotOrder(_2e);}}return this;},addSeries:function(_2f,_30,_31){var run=new dc.Series(this,_30,_31);run.name=_2f;if(_2f in this.runs){this.series[this.runs[_2f]].destroy();this.series[this.runs[_2f]]=run;}else{this.runs[_2f]=this.series.length;this.series.push(run);}this.dirty=true;if(!("ymin" in run)&&"min" in run){run.ymin=run.min;}if(!("ymax" in run)&&"max" in run){run.ymax=run.max;}return this;},removeSeries:function(_32){if(_32 in this.runs){var _33=this.runs[_32];delete this.runs[_32];this.series[_33].destroy();this.series.splice(_33,1);df.forIn(this.runs,function(idx,_34,_35){if(idx>_33){_35[_34]=idx-1;}});this.dirty=true;}return this;},updateSeries:function(_36,_37){if(_36 in this.runs){var run=this.series[this.runs[_36]];run.update(_37);this._invalidateDependentPlots(run.plot,false);this._invalidateDependentPlots(run.plot,true);}return this;},getSeriesOrder:function(_38){return df.map(df.filter(this.series,function(run){return run.plot==_38;}),_c);},setSeriesOrder:function(_39){var _3a,_3b={},_3c=df.filter(_39,function(_3d){if(!(_3d in this.runs)||(_3d in _3b)){return false;}var run=this.series[this.runs[_3d]];if(_3a){if(run.plot!=_3a){return false;}}else{_3a=run.plot;}_3b[_3d]=1;return true;},this);df.forEach(this.series,function(run){var _3e=run.name;if(!(_3e in _3b)&&run.plot==_3a){_3c.push(_3e);}});var _3f=df.map(_3c,function(_40){return this.series[this.runs[_40]];},this);this.series=_3f.concat(df.filter(this.series,function(run){return run.plot!=_3a;}));df.forEach(this.series,function(run,i){this.runs[run.name]=i;},this);this.dirty=true;return this;},moveSeriesToFront:function(_41){if(_41 in this.runs){var _42=this.runs[_41],_43=this.getSeriesOrder(this.series[_42].plot);if(_41!=_43[0]){_43.splice(_42,1);_43.unshift(_41);return this.setSeriesOrder(_43);}}return this;},moveSeriesToBack:function(_44){if(_44 in this.runs){var _45=this.runs[_44],_46=this.getSeriesOrder(this.series[_45].plot);if(_44!=_46[_46.length-1]){_46.splice(_45,1);_46.push(_44);return this.setSeriesOrder(_46);}}return this;},resize:function(_47,_48){var box;switch(arguments.length){case 1:box=_4.mixin({},_47);_4.marginBox(this.node,box);break;case 2:box={w:_47,h:_48};_4.marginBox(this.node,box);break;}box=_4.marginBox(this.node);this.surface.setDimensions(box.w,box.h);this.dirty=true;this.coords=null;return this.render();},getGeometry:function(){var ret={};df.forIn(this.axes,function(_49){if(_49.initialized()){ret[_49.name]={name:_49.name,vertical:_49.vertical,scaler:_49.scaler,ticks:_49.ticks};}});return ret;},setAxisWindow:function(_4a,_4b,_4c,_4d){var _4e=this.axes[_4a];if(_4e){_4e.setWindow(_4b,_4c);_4.forEach(this.stack,function(_4f){if(_4f.hAxis==_4a||_4f.vAxis==_4a){_4f.zoom=_4d;}});}return this;},setWindow:function(sx,sy,dx,dy,_50){if(!("plotArea" in this)){this.calculateGeometry();}df.forIn(this.axes,function(_51){var _52,_53,_54=_51.getScaler().bounds,s=_54.span/(_54.upper-_54.lower);if(_51.vertical){_52=sy;_53=dy/s/_52;}else{_52=sx;_53=dx/s/_52;}_51.setWindow(_52,_53);});_4.forEach(this.stack,function(_55){_55.zoom=_50;});return this;},zoomIn:function(_56,_57){var _58=this.axes[_56];if(_58){var _59,_5a,_5b=_58.getScaler().bounds;var _5c=Math.min(_57[0],_57[1]);var _5d=Math.max(_57[0],_57[1]);_5c=_57[0]<_5b.lower?_5b.lower:_5c;_5d=_57[1]>_5b.upper?_5b.upper:_5d;_59=(_5b.upper-_5b.lower)/(_5d-_5c);_5a=_5c-_5b.lower;this.setAxisWindow(_56,_59,_5a);this.render();}},calculateGeometry:function(){if(this.dirty){return this.fullGeometry();}var _5e=_4.filter(this.stack,function(_5f){return _5f.dirty||(_5f.hAxis&&this.axes[_5f.hAxis].dirty)||(_5f.vAxis&&this.axes[_5f.vAxis].dirty);},this);_60(_5e,this.plotArea);return this;},fullGeometry:function(){this._makeDirty();_4.forEach(this.stack,_7);if(!this.theme){this.setTheme(new _6.charting.Theme(_6.charting._def));}_4.forEach(this.series,function(run){if(!(run.plot in this.plots)){if(!dc.plot2d||!dc.plot2d.Default){throw Error("Can't find plot: Default - didn't you forget to dojo"+".require() it?");}var _61=new dc.plot2d.Default(this,{});_61.name=run.plot;this.plots[run.plot]=this.stack.length;this.stack.push(_61);}this.stack[this.plots[run.plot]].addSeries(run);},this);_4.forEach(this.stack,function(_62){if(_62.hAxis){_62.setAxis(this.axes[_62.hAxis]);}if(_62.vAxis){_62.setAxis(this.axes[_62.vAxis]);}},this);var dim=this.dim=this.surface.getDimensions();dim.width=g.normalizedLength(dim.width);dim.height=g.normalizedLength(dim.height);df.forIn(this.axes,_7);_60(this.stack,dim);var _63=this.offsets={l:0,r:0,t:0,b:0};df.forIn(this.axes,function(_64){df.forIn(_64.getOffsets(),function(o,i){_63[i]+=o;});});if(this.title){this.titleGap=(this.titleGap==0)?0:this.titleGap||this.theme.chart.titleGap||20;this.titlePos=this.titlePos||this.theme.chart.titlePos||"top";this.titleFont=this.titleFont||this.theme.chart.titleFont;this.titleFontColor=this.titleFontColor||this.theme.chart.titleFontColor||"black";var _65=g.normalizedLength(g.splitFontString(this.titleFont).size);_63[this.titlePos=="top"?"t":"b"]+=(_65+this.titleGap);}df.forIn(this.margins,function(o,i){_63[i]+=o;});this.plotArea={width:dim.width-_63.l-_63.r,height:dim.height-_63.t-_63.b};df.forIn(this.axes,_7);_60(this.stack,this.plotArea);return this;},render:function(){if(this.theme){this.theme.clear();}if(this.dirty){return this.fullRender();}this.calculateGeometry();df.forEachRev(this.stack,function(_66){_66.render(this.dim,this.offsets);},this);df.forIn(this.axes,function(_67){_67.render(this.dim,this.offsets);},this);this._makeClean();if(this.surface.render){this.surface.render();}return this;},fullRender:function(){this.fullGeometry();var _68=this.offsets,dim=this.dim,_69;_4.forEach(this.series,_8);df.forIn(this.axes,_8);_4.forEach(this.stack,_8);if(this.chartTitle&&this.chartTitle.tagName){_4.destroy(this.chartTitle);}this.surface.clear();this.chartTitle=null;var t=this.theme,_6a=t.plotarea&&t.plotarea.fill,_6b=t.plotarea&&t.plotarea.stroke,_69={x:_68.l-1,y:_68.t-1,width:dim.width-_68.l-_68.r+2,height:dim.height-_68.t-_68.b+2};if(_6a){_6a=dc.Element.prototype._shapeFill(dc.Element.prototype._plotFill(_6a,dim,_68),_69);this.surface.createRect(_69).setFill(_6a);}if(_6b){this.surface.createRect({x:_68.l,y:_68.t,width:dim.width-_68.l-_68.r+1,height:dim.height-_68.t-_68.b+1}).setStroke(_6b);}df.foldr(this.stack,function(z,_6c){return _6c.render(dim,_68),0;},0);_6a=this.fill!==undefined?this.fill:(t.chart&&t.chart.fill);_6b=this.stroke!==undefined?this.stroke:(t.chart&&t.chart.stroke);if(_6a=="inherit"){var _6d=this.node,_6a=new _4.Color(_4.style(_6d,"backgroundColor"));while(_6a.a==0&&_6d!=document.documentElement){_6a=new _4.Color(_4.style(_6d,"backgroundColor"));_6d=_6d.parentNode;}}if(_6a){_6a=dc.Element.prototype._plotFill(_6a,dim,_68);if(_68.l){_69={width:_68.l,height:dim.height+1};this.surface.createRect(_69).setFill(dc.Element.prototype._shapeFill(_6a,_69));}if(_68.r){_69={x:dim.width-_68.r,width:_68.r+1,height:dim.height+2};this.surface.createRect(_69).setFill(dc.Element.prototype._shapeFill(_6a,_69));}if(_68.t){_69={width:dim.width+1,height:_68.t};this.surface.createRect(_69).setFill(dc.Element.prototype._shapeFill(_6a,_69));}if(_68.b){_69={y:dim.height-_68.b,width:dim.width+1,height:_68.b+2};this.surface.createRect(_69).setFill(dc.Element.prototype._shapeFill(_6a,_69));}}if(_6b){this.surface.createRect({width:dim.width-1,height:dim.height-1}).setStroke(_6b);}if(this.title){var _6e=(g.renderer=="canvas"),_6f=_6e||!_4.isIE&&!_4.isOpera?"html":"gfx",_70=g.normalizedLength(g.splitFontString(this.titleFont).size);this.chartTitle=dc.axis2d.common.createText[_6f](this,this.surface,dim.width/2,this.titlePos=="top"?_70+this.margins.t:dim.height-this.margins.b,"middle",this.title,this.titleFont,this.titleFontColor);}df.forIn(this.axes,function(_71){_71.render(dim,_68);});this._makeClean();if(this.surface.render){this.surface.render();}return this;},delayedRender:function(){if(!this._delayedRenderHandle){this._delayedRenderHandle=setTimeout(_4.hitch(this,function(){clearTimeout(this._delayedRenderHandle);this._delayedRenderHandle=null;this.render();}),this.delayInMs);}return this;},connectToPlot:function(_72,_73,_74){return _72 in this.plots?this.stack[this.plots[_72]].connect(_73,_74):null;},fireEvent:function(_75,_76,_77){if(_75 in this.runs){var _78=this.series[this.runs[_75]].plot;if(_78 in this.plots){var _79=this.stack[this.plots[_78]];if(_79){_79.fireEvent(_75,_76,_77);}}}return this;},_makeClean:function(){_4.forEach(this.axes,_a);_4.forEach(this.stack,_a);_4.forEach(this.series,_a);this.dirty=false;},_makeDirty:function(){_4.forEach(this.axes,_b);_4.forEach(this.stack,_b);_4.forEach(this.series,_b);this.dirty=true;},_invalidateDependentPlots:function(_7a,_7b){if(_7a in this.plots){var _7c=this.stack[this.plots[_7a]],_7d,_7e=_7b?"vAxis":"hAxis";if(_7c[_7e]){_7d=this.axes[_7c[_7e]];if(_7d&&_7d.dependOnData()){_7d.dirty=true;_4.forEach(this.stack,function(p){if(p[_7e]&&p[_7e]==_7c[_7e]){p.dirty=true;}});}}else{_7c.dirty=true;}}}});function _7f(_80){return {min:_80.hmin,max:_80.hmax};};function _81(_82){return {min:_82.vmin,max:_82.vmax};};function _83(_84,h){_84.hmin=h.min;_84.hmax=h.max;};function _85(_86,v){_86.vmin=v.min;_86.vmax=v.max;};function _87(_88,_89){if(_88&&_89){_88.min=Math.min(_88.min,_89.min);_88.max=Math.max(_88.max,_89.max);}return _88||_89;};function _60(_8a,_8b){var _8c={},_8d={};_4.forEach(_8a,function(_8e){var _8f=_8c[_8e.name]=_8e.getSeriesStats();if(_8e.hAxis){_8d[_8e.hAxis]=_87(_8d[_8e.hAxis],_7f(_8f));}if(_8e.vAxis){_8d[_8e.vAxis]=_87(_8d[_8e.vAxis],_81(_8f));}});_4.forEach(_8a,function(_90){var _91=_8c[_90.name];if(_90.hAxis){_83(_91,_8d[_90.hAxis]);}if(_90.vAxis){_85(_91,_8d[_90.vAxis]);}_90.initializeScalers(_8b,_91);});};})();}}};});