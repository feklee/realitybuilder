/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


realitybuilderDojo._xdResourceLoaded(function(_1,_2,_3){return {depends:[["provide","dojox.charting.plot2d.Spider"],["require","dojox.charting.Element"],["require","dojox.charting.plot2d._PlotEvents"],["require","dojox.charting.axis2d.common"],["require","dojox.charting.plot2d.common"],["require","dojox.charting.scaler.primitive"],["require","dojox.lang.functional"],["require","dojox.lang.utils"],["require","dojox.gfx"],["require","dojo.fx"],["require","dojo.fx.easing"],["require","dojox.gfx.fx"]],defineResource:function(_4,_5,_6){if(!_4._hasResource["dojox.charting.plot2d.Spider"]){_4._hasResource["dojox.charting.plot2d.Spider"]=true;_4.provide("dojox.charting.plot2d.Spider");_4.experimental("dojox.charting.plot2d.Spider");_4.require("dojox.charting.Element");_4.require("dojox.charting.plot2d._PlotEvents");_4.require("dojox.charting.axis2d.common");_4.require("dojox.charting.plot2d.common");_4.require("dojox.charting.scaler.primitive");_4.require("dojox.lang.functional");_4.require("dojox.lang.utils");_4.require("dojox.gfx");_4.require("dojo.fx");_4.require("dojo.fx.easing");_4.require("dojox.gfx.fx");(function(){var df=_6.lang.functional,du=_6.lang.utils,dc=_6.charting.plot2d.common,da=_6.charting.axis2d.common,g=_6.gfx,m=g.matrix,_7=0.2;_4.declare("dojox.charting.plot2d.Spider",[_6.charting.Element,_6.charting.plot2d._PlotEvents],{defaultParams:{labels:true,ticks:false,fixed:true,precision:1,labelOffset:-10,labelStyle:"default",htmlLabels:true,startAngle:-90,divisions:3,axisColor:"",axisWidth:0,spiderColor:"",spiderWidth:0,seriesWidth:0,seriesFillAlpha:0.2,spiderOrigin:0.16,markerSize:3,spiderType:"polygon",animationType:_4.fx.easing.backOut,axisTickFont:"",axisTickFontColor:"",axisFont:"",axisFontColor:""},optionalParams:{radius:0,font:"",fontColor:""},constructor:function(_8,_9){this.opt=_4.clone(this.defaultParams);du.updateWithObject(this.opt,_9);du.updateWithPattern(this.opt,_9,this.optionalParams);this.series=[];this.dyn=[];this.datas={};this.labelKey=[];this.oldSeriePoints={};this.animations={};},clear:function(){this.dirty=true;this.dyn=[];this.series=[];this.datas={};this.labelKey=[];this.oldSeriePoints={};this.animations={};return this;},setAxis:function(_a){return this;},addSeries:function(_b){var _c=false;this.series.push(_b);for(var _d in _b.data){var _e=_b.data[_d],_f=this.datas[_d];if(_f){_f.vlist.push(_e);_f.min=Math.min(_f.min,_e);_f.max=Math.max(_f.max,_e);}else{this.datas[_d]={min:_e,max:_e,vlist:[_e]};}}if(this.labelKey.length<=0){for(var _d in _b.data){this.labelKey.push(_d);}}return this;},getSeriesStats:function(){return _6.charting.plot2d.common.collectSimpleStats(this.series);},calculateAxes:function(dim){this.initializeScalers(dim,this.getSeriesStats());return this;},getRequiredColors:function(){return this.series.length;},initializeScalers:function(dim,_10){if(this._hAxis){if(!this._hAxis.initialized()){this._hAxis.calculate(_10.hmin,_10.hmax,dim.width);}this._hScaler=this._hAxis.getScaler();}else{this._hScaler=_6.charting.scaler.primitive.buildScaler(_10.hmin,_10.hmax,dim.width);}if(this._vAxis){if(!this._vAxis.initialized()){this._vAxis.calculate(_10.vmin,_10.vmax,dim.height);}this._vScaler=this._vAxis.getScaler();}else{this._vScaler=_6.charting.scaler.primitive.buildScaler(_10.vmin,_10.vmax,dim.height);}return this;},render:function(dim,_11){if(!this.dirty){return this;}this.dirty=false;this.cleanGroup();var s=this.group,t=this.chart.theme;this.resetEvents();if(!this.series||!this.series.length){return this;}var o=this.opt,ta=t.axis,rx=(dim.width-_11.l-_11.r)/2,ry=(dim.height-_11.t-_11.b)/2,r=Math.min(rx,ry),_12=o.font||(ta.majorTick&&ta.majorTick.font)||(ta.tick&&ta.tick.font)||"normal normal normal 7pt Tahoma",_13=o.axisFont||(ta.tick&&ta.tick.titleFont)||"normal normal normal 11pt Tahoma",_14=o.axisTickFontColor||(ta.majorTick&&ta.majorTick.fontColor)||(ta.tick&&ta.tick.fontColor)||"silver",_15=o.axisFontColor||(ta.tick&&ta.tick.titleFontColor)||"black",_16=o.axisColor||(ta.tick&&ta.tick.axisColor)||"silver",_17=o.spiderColor||(ta.tick&&ta.tick.spiderColor)||"silver",_18=o.axisWidth||(ta.stroke&&ta.stroke.width)||2,_19=o.spiderWidth||(ta.stroke&&ta.stroke.width)||2,_1a=o.seriesWidth||(ta.stroke&&ta.stroke.width)||2,_1b=g.normalizedLength(g.splitFontString(_13).size),_1c=m._degToRad(o.startAngle),_1d=_1c,_1e,_1f,_20,_21,_22,_23,_24,_25,_26,_27,_28,ro=o.spiderOrigin,dv=o.divisions>=3?o.divisions:3,ms=o.markerSize,spt=o.spiderType,at=o.animationType,_29=o.labelOffset<-10?o.labelOffset:-10,_2a=0.2;if(o.labels){_21=_4.map(this.series,function(s){return s.name;},this);_22=df.foldl1(df.map(_21,function(_2b,i){var _2c=t.series.font;return _6.gfx._base._getTextBox(_2b,{font:_2c}).w;},this),"Math.max(a, b)")/2;r=Math.min(rx-2*_22,ry-_1b)+_29;_23=r-_29;}if("radius" in o){r=o.radius;_23=r-_29;}r/=(1+_2a);var _2d={cx:_11.l+rx,cy:_11.t+ry,r:r};for(var i=this.series.length-1;i>=0;i--){var _2e=this.series[i];if(!this.dirty&&!_2e.dirty){t.skip();continue;}_2e.cleanGroup();var run=_2e.data;if(run!==null){var len=this._getObjectLength(run);if(!_24||_24.length<=0){_24=[],_25=[],_28=[];this._buildPoints(_24,len,_2d,r,_1d,true);this._buildPoints(_25,len,_2d,r*ro,_1d,true);this._buildPoints(_28,len,_2d,_23,_1d);if(dv>2){_26=[],_27=[];for(var j=0;j<dv-2;j++){_26[j]=[];this._buildPoints(_26[j],len,_2d,r*(ro+(1-ro)*(j+1)/(dv-1)),_1d,true);_27[j]=r*(ro+(1-ro)*(j+1)/(dv-1));}}}}}var _2f=s.createGroup(),_30={color:_16,width:_18},_31={color:_17,width:_19};for(var j=_24.length-1;j>=0;--j){var _32=_24[j],st={x:_32.x+(_32.x-_2d.cx)*_2a,y:_32.y+(_32.y-_2d.cy)*_2a},nd={x:_32.x+(_32.x-_2d.cx)*_2a/2,y:_32.y+(_32.y-_2d.cy)*_2a/2};_2f.createLine({x1:_2d.cx,y1:_2d.cy,x2:st.x,y2:st.y}).setStroke(_30);this._drawArrow(_2f,st,nd,_30);}var _33=s.createGroup();for(var j=_28.length-1;j>=0;--j){var _32=_28[j],_34=_6.gfx._base._getTextBox(this.labelKey[j],{font:_13}).w||0,_35=this.opt.htmlLabels&&_6.gfx.renderer!="vml"?"html":"gfx";elem=da.createText[_35](this.chart,_33,(!_4._isBodyLtr()&&_35=="html")?(_32.x+_34-dim.width):_32.x,_32.y,"middle",this.labelKey[j],_13,_15);if(this.opt.htmlLabels){this.htmlElements.push(elem);}}var _36=s.createGroup();if(spt=="polygon"){_36.createPolyline(_24).setStroke(_31);_36.createPolyline(_25).setStroke(_31);if(_26.length>0){for(var j=_26.length-1;j>=0;--j){_36.createPolyline(_26[j]).setStroke(_31);}}}else{var _37=this._getObjectLength(this.datas);_36.createCircle({cx:_2d.cx,cy:_2d.cy,r:r}).setStroke(_31);_36.createCircle({cx:_2d.cx,cy:_2d.cy,r:r*ro}).setStroke(_31);if(_27.length>0){for(var j=_27.length-1;j>=0;--j){_36.createCircle({cx:_2d.cx,cy:_2d.cy,r:_27[j]}).setStroke(_31);}}}var _38=s.createGroup(),len=this._getObjectLength(this.datas),k=0;for(var key in this.datas){var _39=this.datas[key],min=_39.min,max=_39.max,_3a=max-min,end=_1d+2*Math.PI*k/len;for(var i=0;i<dv;i++){var _3b=min+_3a*i/(dv-1),_32=this._getCoordinate(_2d,r*(ro+(1-ro)*i/(dv-1)),end);_3b=this._getLabel(_3b);var _34=_6.gfx._base._getTextBox(_3b,{font:_12}).w||0,_35=this.opt.htmlLabels&&_6.gfx.renderer!="vml"?"html":"gfx";if(this.opt.htmlLabels){this.htmlElements.push(da.createText[_35](this.chart,_38,(!_4._isBodyLtr()&&_35=="html")?(_32.x+_34-dim.width):_32.x,_32.y,"start",_3b,_12,_14));}}k++;}this.chart.seriesShapes={};var _3c=[];for(var i=this.series.length-1;i>=0;i--){var _2e=this.series[i],run=_2e.data;if(run!==null){var _3d=[],k=0,_3e=[];for(var key in run){var _39=this.datas[key],min=_39.min,max=_39.max,_3a=max-min,_3f=run[key],end=_1d+2*Math.PI*k/len,_32=this._getCoordinate(_2d,r*(ro+(1-ro)*(_3f-min)/_3a),end);_3d.push(_32);_3e.push({sname:_2e.name,key:key,data:_3f});k++;}_3d[_3d.length]=_3d[0];_3e[_3e.length]=_3e[0];var _40=this._getBoundary(_3d),_41=t.next("spider",[o,_2e]),ts=_2e.group,f=g.normalizeColor(_41.series.fill),sk={color:_41.series.fill,width:_1a};f.a=o.seriesFillAlpha;_2e.dyn={fill:f,stroke:sk};var _42=this.oldSeriePoints[_2e.name];var cs=this._createSeriesEntry(ts,(_42||_25),_3d,f,sk,r,ro,ms,at);this.chart.seriesShapes[_2e.name]=cs;this.oldSeriePoints[_2e.name]=_3d;var po={element:"spider_poly",index:i,id:"spider_poly_"+_2e.name,run:_2e,plot:this,shape:cs.poly,parent:ts,brect:_40,cx:_2d.cx,cy:_2d.cy,cr:r,f:f,s:s};this._connectEvents(po);var so={element:"spider_plot",index:i,id:"spider_plot_"+_2e.name,run:_2e,plot:this,shape:_2e.group};this._connectEvents(so);_4.forEach(cs.circles,function(c,i){var _43=c.getShape(),co={element:"spider_circle",index:i,id:"spider_circle_"+_2e.name+i,run:_2e,plot:this,shape:c,parent:ts,tdata:_3e[i],cx:_3d[i].x,cy:_3d[i].y,f:f,s:s};this._connectEvents(co);},this);}}return this;},_createSeriesEntry:function(ts,_44,sps,f,sk,r,ro,ms,at){var _45=ts.createPolyline(_44).setFill(f).setStroke(sk),_46=[];for(var j=0;j<_44.length;j++){var _47=_44[j],cr=ms;var _48=ts.createCircle({cx:_47.x,cy:_47.y,r:cr}).setFill(f).setStroke(sk);_46.push(_48);}var _49=_4.map(sps,function(np,j){var sp=_44[j],_4a=new _4._Animation({duration:1000,easing:at,curve:[sp.y,np.y]});var spl=_45,sc=_46[j];_4.connect(_4a,"onAnimate",function(y){var _4b=spl.getShape();_4b.points[j].y=y;spl.setShape(_4b);var _4c=sc.getShape();_4c.cy=y;sc.setShape(_4c);});return _4a;});var _4d=_4.map(sps,function(np,j){var sp=_44[j],_4e=new _4._Animation({duration:1000,easing:at,curve:[sp.x,np.x]});var spl=_45,sc=_46[j];_4.connect(_4e,"onAnimate",function(x){var _4f=spl.getShape();_4f.points[j].x=x;spl.setShape(_4f);var _50=sc.getShape();_50.cx=x;sc.setShape(_50);});return _4e;});var _51=_4.fx.combine(_49.concat(_4d));_51.play();return {group:ts,poly:_45,circles:_46};},plotEvent:function(o){var _52=o.id?o.id:"default",a;if(_52 in this.animations){a=this.animations[_52];a.anim&&a.anim.stop(true);}else{a=this.animations[_52]={};}if(o.element=="spider_poly"){if(!a.color){var _53=o.shape.getFill();if(!_53||!(_53 instanceof _4.Color)){return;}a.color={start:_53,end:_54(_53)};}var _55=a.color.start,end=a.color.end;if(o.type=="onmouseout"){var t=_55;_55=end;end=t;}a.anim=_6.gfx.fx.animateFill({shape:o.shape,duration:800,easing:_4.fx.easing.backOut,color:{start:_55,end:end}});a.anim.play();}else{if(o.element=="spider_circle"){var _56,_57,_58=1.5;if(o.type=="onmouseover"){_56=_6.gfx.matrix.identity;_57=_58;var _59={type:"rect"};_59.x=o.cx;_59.y=o.cy;_59.width=_59.height=1;var lt=_4.coords(this.chart.node,true);_59.x+=lt.x;_59.y+=lt.y;_59.x=Math.round(_59.x);_59.y=Math.round(_59.y);_59.width=Math.ceil(_59.width);_59.height=Math.ceil(_59.height);this.aroundRect=_59;var _5a=["after","before"];if(_5&&_5.Tooltip){_5.showTooltip(o.tdata.sname+"<br/>"+o.tdata.key+"<br/>"+o.tdata.data,this.aroundRect,_5a);}}else{_56=_6.gfx.matrix.scaleAt(_58,o.cx,o.cy);_57=1/_58;if(_5&&_5.Tooltip){this.aroundRect&&_5.hideTooltip(this.aroundRect);}}var cs=o.shape.getShape(),_56=m.scaleAt(_58,cs.cx,cs.cy),_5b={shape:o.shape,duration:200,easing:_4.fx.easing.backOut,transform:[{name:"scaleAt",start:[1,cs.cx,cs.cy],end:[_57,cs.cx,cs.cy]},_56]};a.anim=_6.gfx.fx.animateTransform(_5b);a.anim.play();}else{if(o.element=="spider_plot"){if(o.type=="onmouseover"&&!_4.isIE){o.shape.moveToFront();}}}}},_getBoundary:function(_5c){var _5d=_5c[0].x,_5e=_5c[0].x,_5f=_5c[0].y,_60=_5c[0].y;for(var i=0;i<_5c.length;i++){var _61=_5c[i];_5d=Math.max(_61.x,_5d);_5f=Math.max(_61.y,_5f);_5e=Math.min(_61.x,_5e);_60=Math.min(_61.y,_60);}return {x:_5e,y:_60,width:_5d-_5e,height:_5f-_60};},_drawArrow:function(s,_62,end,_63){var len=Math.sqrt(Math.pow(end.x-_62.x,2)+Math.pow(end.y-_62.y,2)),sin=(end.y-_62.y)/len,cos=(end.x-_62.x)/len,_64={x:end.x+(len/3)*(-sin),y:end.y+(len/3)*cos},_65={x:end.x+(len/3)*sin,y:end.y+(len/3)*(-cos)};s.createPolyline([_62,_64,_65]).setFill(_63.color).setStroke(_63);},_buildPoints:function(_66,_67,_68,_69,_6a,_6b){for(var i=0;i<_67;i++){var end=_6a+2*Math.PI*i/_67;_66.push(this._getCoordinate(_68,_69,end));}if(_6b){_66.push(this._getCoordinate(_68,_69,_6a+2*Math.PI));}},_getCoordinate:function(_6c,_6d,_6e){return {x:_6c.cx+_6d*Math.cos(_6e),y:_6c.cy+_6d*Math.sin(_6e)};},_getObjectLength:function(obj){var _6f=0;if(_4.isObject(obj)){for(var key in obj){_6f++;}}return _6f;},_getLabel:function(_70){return dc.getLabel(_70,this.opt.fixed,this.opt.precision);}});function _54(_71){var a=new _6.color.Color(_71),x=a.toHsl();if(x.s==0){x.l=x.l<50?100:0;}else{x.s=100;if(x.l<50){x.l=75;}else{if(x.l>75){x.l=50;}else{x.l=x.l-50>75-x.l?50:75;}}}var _71=_6.color.fromHsl(x);_71.a=0.7;return _71;};})();}}};});