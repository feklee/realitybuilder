/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


realitybuilderDojo._xdResourceLoaded(function(_1,_2,_3){return {depends:[["provide","dojox.gfx.svg"],["require","dojox.gfx._base"],["require","dojox.gfx.shape"],["require","dojox.gfx.path"]],defineResource:function(_4,_5,_6){if(!_4._hasResource["dojox.gfx.svg"]){_4._hasResource["dojox.gfx.svg"]=true;_4.provide("dojox.gfx.svg");_4.require("dojox.gfx._base");_4.require("dojox.gfx.shape");_4.require("dojox.gfx.path");(function(){var d=_4,g=_6.gfx,gs=g.shape,_7=g.svg;_7.useSvgWeb=(typeof window.svgweb!="undefined");function _8(ns,_9){if(_4.doc.createElementNS){return _4.doc.createElementNS(ns,_9);}else{return _4.doc.createElement(_9);}};function _a(_b){if(_7.useSvgWeb){return _4.doc.createTextNode(_b,true);}else{return _4.doc.createTextNode(_b);}};function _c(){if(_7.useSvgWeb){return _4.doc.createDocumentFragment(true);}else{return _4.doc.createDocumentFragment();}};_7.xmlns={xlink:"http://www.w3.org/1999/xlink",svg:"http://www.w3.org/2000/svg"};_7.getRef=function(_d){if(!_d||_d=="none"){return null;}if(_d.match(/^url\(#.+\)$/)){return d.byId(_d.slice(5,-1));}if(_d.match(/^#dojoUnique\d+$/)){return d.byId(_d.slice(1));}return null;};_7.dasharray={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]};d.declare("dojox.gfx.svg.Shape",gs.Shape,{setFill:function(_e){if(!_e){this.fillStyle=null;this.rawNode.setAttribute("fill","none");this.rawNode.setAttribute("fill-opacity",0);return this;}var f;var _f=function(x){this.setAttribute(x,f[x].toFixed(8));};if(typeof (_e)=="object"&&"type" in _e){switch(_e.type){case "linear":f=g.makeParameters(g.defaultLinearGradient,_e);var _10=this._setFillObject(f,"linearGradient");d.forEach(["x1","y1","x2","y2"],_f,_10);break;case "radial":f=g.makeParameters(g.defaultRadialGradient,_e);var _10=this._setFillObject(f,"radialGradient");d.forEach(["cx","cy","r"],_f,_10);break;case "pattern":f=g.makeParameters(g.defaultPattern,_e);var _11=this._setFillObject(f,"pattern");d.forEach(["x","y","width","height"],_f,_11);break;}this.fillStyle=f;return this;}var f=g.normalizeColor(_e);this.fillStyle=f;this.rawNode.setAttribute("fill",f.toCss());this.rawNode.setAttribute("fill-opacity",f.a);this.rawNode.setAttribute("fill-rule","evenodd");return this;},setStroke:function(_12){var rn=this.rawNode;if(!_12){this.strokeStyle=null;rn.setAttribute("stroke","none");rn.setAttribute("stroke-opacity",0);return this;}if(typeof _12=="string"||d.isArray(_12)||_12 instanceof d.Color){_12={color:_12};}var s=this.strokeStyle=g.makeParameters(g.defaultStroke,_12);s.color=g.normalizeColor(s.color);if(s){rn.setAttribute("stroke",s.color.toCss());rn.setAttribute("stroke-opacity",s.color.a);rn.setAttribute("stroke-width",s.width);rn.setAttribute("stroke-linecap",s.cap);if(typeof s.join=="number"){rn.setAttribute("stroke-linejoin","miter");rn.setAttribute("stroke-miterlimit",s.join);}else{rn.setAttribute("stroke-linejoin",s.join);}var da=s.style.toLowerCase();if(da in _7.dasharray){da=_7.dasharray[da];}if(da instanceof Array){da=d._toArray(da);for(var i=0;i<da.length;++i){da[i]*=s.width;}if(s.cap!="butt"){for(var i=0;i<da.length;i+=2){da[i]-=s.width;if(da[i]<1){da[i]=1;}}for(var i=1;i<da.length;i+=2){da[i]+=s.width;}}da=da.join(",");}rn.setAttribute("stroke-dasharray",da);rn.setAttribute("dojoGfxStrokeStyle",s.style);}return this;},_getParentSurface:function(){var _13=this.parent;for(;_13&&!(_13 instanceof g.Surface);_13=_13.parent){}return _13;},_setFillObject:function(f,_14){var _15=_7.xmlns.svg;this.fillStyle=f;var _16=this._getParentSurface(),_17=_16.defNode,_18=this.rawNode.getAttribute("fill"),ref=_7.getRef(_18);if(ref){_18=ref;if(_18.tagName.toLowerCase()!=_14.toLowerCase()){var id=_18.id;_18.parentNode.removeChild(_18);_18=_8(_15,_14);_18.setAttribute("id",id);_17.appendChild(_18);}else{while(_18.childNodes.length){_18.removeChild(_18.lastChild);}}}else{_18=_8(_15,_14);_18.setAttribute("id",g._base._getUniqueId());_17.appendChild(_18);}if(_14=="pattern"){_18.setAttribute("patternUnits","userSpaceOnUse");var img=_8(_15,"image");img.setAttribute("x",0);img.setAttribute("y",0);img.setAttribute("width",f.width.toFixed(8));img.setAttribute("height",f.height.toFixed(8));img.setAttributeNS(_7.xmlns.xlink,"xlink:href",f.src);_18.appendChild(img);}else{_18.setAttribute("gradientUnits","userSpaceOnUse");for(var i=0;i<f.colors.length;++i){var c=f.colors[i],t=_8(_15,"stop"),cc=c.color=g.normalizeColor(c.color);t.setAttribute("offset",c.offset.toFixed(8));t.setAttribute("stop-color",cc.toCss());t.setAttribute("stop-opacity",cc.a);_18.appendChild(t);}}this.rawNode.setAttribute("fill","url(#"+_18.getAttribute("id")+")");this.rawNode.removeAttribute("fill-opacity");this.rawNode.setAttribute("fill-rule","evenodd");return _18;},_applyTransform:function(){var _19=this.matrix;if(_19){var tm=this.matrix;this.rawNode.setAttribute("transform","matrix("+tm.xx.toFixed(8)+","+tm.yx.toFixed(8)+","+tm.xy.toFixed(8)+","+tm.yy.toFixed(8)+","+tm.dx.toFixed(8)+","+tm.dy.toFixed(8)+")");}else{this.rawNode.removeAttribute("transform");}return this;},setRawNode:function(_1a){var r=this.rawNode=_1a;if(this.shape.type!="image"){r.setAttribute("fill","none");}r.setAttribute("fill-opacity",0);r.setAttribute("stroke","none");r.setAttribute("stroke-opacity",0);r.setAttribute("stroke-width",1);r.setAttribute("stroke-linecap","butt");r.setAttribute("stroke-linejoin","miter");r.setAttribute("stroke-miterlimit",4);},setShape:function(_1b){this.shape=g.makeParameters(this.shape,_1b);for(var i in this.shape){if(i!="type"){this.rawNode.setAttribute(i,this.shape[i]);}}this.bbox=null;return this;},_moveToFront:function(){this.rawNode.parentNode.appendChild(this.rawNode);return this;},_moveToBack:function(){this.rawNode.parentNode.insertBefore(this.rawNode,this.rawNode.parentNode.firstChild);return this;}});_4.declare("dojox.gfx.svg.Group",_7.Shape,{constructor:function(){gs.Container._init.call(this);},setRawNode:function(_1c){this.rawNode=_1c;}});_7.Group.nodeType="g";_4.declare("dojox.gfx.svg.Rect",[_7.Shape,gs.Rect],{setShape:function(_1d){this.shape=g.makeParameters(this.shape,_1d);this.bbox=null;for(var i in this.shape){if(i!="type"&&i!="r"){this.rawNode.setAttribute(i,this.shape[i]);}}if(this.shape.r){this.rawNode.setAttribute("ry",this.shape.r);this.rawNode.setAttribute("rx",this.shape.r);}return this;}});_7.Rect.nodeType="rect";_4.declare("dojox.gfx.svg.Ellipse",[_7.Shape,gs.Ellipse],{});_7.Ellipse.nodeType="ellipse";_4.declare("dojox.gfx.svg.Circle",[_7.Shape,gs.Circle],{});_7.Circle.nodeType="circle";_4.declare("dojox.gfx.svg.Line",[_7.Shape,gs.Line],{});_7.Line.nodeType="line";_4.declare("dojox.gfx.svg.Polyline",[_7.Shape,gs.Polyline],{setShape:function(_1e,_1f){if(_1e&&_1e instanceof Array){this.shape=g.makeParameters(this.shape,{points:_1e});if(_1f&&this.shape.points.length){this.shape.points.push(this.shape.points[0]);}}else{this.shape=g.makeParameters(this.shape,_1e);}this.bbox=null;this._normalizePoints();var _20=[],p=this.shape.points;for(var i=0;i<p.length;++i){_20.push(p[i].x.toFixed(8),p[i].y.toFixed(8));}this.rawNode.setAttribute("points",_20.join(" "));return this;}});_7.Polyline.nodeType="polyline";_4.declare("dojox.gfx.svg.Image",[_7.Shape,gs.Image],{setShape:function(_21){this.shape=g.makeParameters(this.shape,_21);this.bbox=null;var _22=this.rawNode;for(var i in this.shape){if(i!="type"&&i!="src"){_22.setAttribute(i,this.shape[i]);}}_22.setAttribute("preserveAspectRatio","none");_22.setAttributeNS(_7.xmlns.xlink,"xlink:href",this.shape.src);return this;}});_7.Image.nodeType="image";_4.declare("dojox.gfx.svg.Text",[_7.Shape,gs.Text],{setShape:function(_23){this.shape=g.makeParameters(this.shape,_23);this.bbox=null;var r=this.rawNode,s=this.shape;r.setAttribute("x",s.x);r.setAttribute("y",s.y);r.setAttribute("text-anchor",s.align);r.setAttribute("text-decoration",s.decoration);r.setAttribute("rotate",s.rotated?90:0);r.setAttribute("kerning",s.kerning?"auto":0);r.setAttribute("text-rendering","optimizeLegibility");if(r.firstChild){r.firstChild.nodeValue=s.text;}else{r.appendChild(_a(s.text));}return this;},getTextWidth:function(){var _24=this.rawNode,_25=_24.parentNode,_26=_24.cloneNode(true);_26.style.visibility="hidden";var _27=0,_28=_26.firstChild.nodeValue;_25.appendChild(_26);if(_28!=""){while(!_27){if(_26.getBBox){_27=parseInt(_26.getBBox().width);}else{_27=68;}}}_25.removeChild(_26);return _27;}});_7.Text.nodeType="text";_4.declare("dojox.gfx.svg.Path",[_7.Shape,g.path.Path],{_updateWithSegment:function(_29){this.inherited(arguments);if(typeof (this.shape.path)=="string"){this.rawNode.setAttribute("d",this.shape.path);}},setShape:function(_2a){this.inherited(arguments);if(this.shape.path){this.rawNode.setAttribute("d",this.shape.path);}else{this.rawNode.removeAttribute("d");}return this;}});_7.Path.nodeType="path";_4.declare("dojox.gfx.svg.TextPath",[_7.Shape,g.path.TextPath],{_updateWithSegment:function(_2b){this.inherited(arguments);this._setTextPath();},setShape:function(_2c){this.inherited(arguments);this._setTextPath();return this;},_setTextPath:function(){if(typeof this.shape.path!="string"){return;}var r=this.rawNode;if(!r.firstChild){var tp=_8(_7.xmlns.svg,"textPath"),tx=_a("");tp.appendChild(tx);r.appendChild(tp);}var ref=r.firstChild.getAttributeNS(_7.xmlns.xlink,"href"),_2d=ref&&_7.getRef(ref);if(!_2d){var _2e=this._getParentSurface();if(_2e){var _2f=_2e.defNode;_2d=_8(_7.xmlns.svg,"path");var id=g._base._getUniqueId();_2d.setAttribute("id",id);_2f.appendChild(_2d);r.firstChild.setAttributeNS(_7.xmlns.xlink,"xlink:href","#"+id);}}if(_2d){_2d.setAttribute("d",this.shape.path);}},_setText:function(){var r=this.rawNode;if(!r.firstChild){var tp=_8(_7.xmlns.svg,"textPath"),tx=_a("");tp.appendChild(tx);r.appendChild(tp);}r=r.firstChild;var t=this.text;r.setAttribute("alignment-baseline","middle");switch(t.align){case "middle":r.setAttribute("text-anchor","middle");r.setAttribute("startOffset","50%");break;case "end":r.setAttribute("text-anchor","end");r.setAttribute("startOffset","100%");break;default:r.setAttribute("text-anchor","start");r.setAttribute("startOffset","0%");break;}r.setAttribute("baseline-shift","0.5ex");r.setAttribute("text-decoration",t.decoration);r.setAttribute("rotate",t.rotated?90:0);r.setAttribute("kerning",t.kerning?"auto":0);r.firstChild.data=t.text;}});_7.TextPath.nodeType="text";_4.declare("dojox.gfx.svg.Surface",gs.Surface,{constructor:function(){gs.Container._init.call(this);},destroy:function(){this.defNode=null;this.inherited(arguments);},setDimensions:function(_30,_31){if(!this.rawNode){return this;}this.rawNode.setAttribute("width",_30);this.rawNode.setAttribute("height",_31);return this;},getDimensions:function(){var t=this.rawNode?{width:g.normalizedLength(this.rawNode.getAttribute("width")),height:g.normalizedLength(this.rawNode.getAttribute("height"))}:null;return t;}});_7.createSurface=function(_32,_33,_34){var s=new _7.Surface();s.rawNode=_8(_7.xmlns.svg,"svg");if(_33){s.rawNode.setAttribute("width",_33);}if(_34){s.rawNode.setAttribute("height",_34);}var _35=_8(_7.xmlns.svg,"defs");s.rawNode.appendChild(_35);s.defNode=_35;s._parent=d.byId(_32);s._parent.appendChild(s.rawNode);return s;};var _36={_setFont:function(){var f=this.fontStyle;this.rawNode.setAttribute("font-style",f.style);this.rawNode.setAttribute("font-variant",f.variant);this.rawNode.setAttribute("font-weight",f.weight);this.rawNode.setAttribute("font-size",f.size);this.rawNode.setAttribute("font-family",f.family);}};var C=gs.Container,_37={openBatch:function(){this.fragment=_c();},closeBatch:function(){if(this.fragment){this.rawNode.appendChild(this.fragment);delete this.fragment;}},add:function(_38){if(this!=_38.getParent()){if(this.fragment){this.fragment.appendChild(_38.rawNode);}else{this.rawNode.appendChild(_38.rawNode);}C.add.apply(this,arguments);}return this;},remove:function(_39,_3a){if(this==_39.getParent()){if(this.rawNode==_39.rawNode.parentNode){this.rawNode.removeChild(_39.rawNode);}if(this.fragment&&this.fragment==_39.rawNode.parentNode){this.fragment.removeChild(_39.rawNode);}C.remove.apply(this,arguments);}return this;},clear:function(){var r=this.rawNode;while(r.lastChild){r.removeChild(r.lastChild);}var _3b=this.defNode;if(_3b){while(_3b.lastChild){_3b.removeChild(_3b.lastChild);}r.appendChild(_3b);}return C.clear.apply(this,arguments);},_moveChildToFront:C._moveChildToFront,_moveChildToBack:C._moveChildToBack};var _3c={createObject:function(_3d,_3e){if(!this.rawNode){return null;}var _3f=new _3d(),_40=_8(_7.xmlns.svg,_3d.nodeType);_3f.setRawNode(_40);_3f.setShape(_3e);this.add(_3f);return _3f;}};d.extend(_7.Text,_36);d.extend(_7.TextPath,_36);d.extend(_7.Group,_37);d.extend(_7.Group,gs.Creator);d.extend(_7.Group,_3c);d.extend(_7.Surface,_37);d.extend(_7.Surface,gs.Creator);d.extend(_7.Surface,_3c);if(_7.useSvgWeb){_7.createSurface=function(_41,_42,_43){var s=new _7.Surface();if(!_42||!_43){var pos=d.position(_41);_42=_42||pos.w;_43=_43||pos.h;}_41=d.byId(_41);var id=_41.id?_41.id+"_svgweb":g._base._getUniqueId();var _44=_8(_7.xmlns.svg,"svg");_44.id=id;_44.setAttribute("width",_42);_44.setAttribute("height",_43);svgweb.appendChild(_44,_41);_44.addEventListener("SVGLoad",function(){s.rawNode=this;s.isLoaded=true;var _45=_8(_7.xmlns.svg,"defs");s.rawNode.appendChild(_45);s.defNode=_45;if(s.onLoad){s.onLoad(s);}},false);s.isLoaded=false;return s;};_7.Surface.extend({destroy:function(){var _46=this.rawNode;svgweb.removeChild(_46,_46.parentNode);}});var _47={connect:function(_48,_49,_4a){if(_48.substring(0,2)==="on"){_48=_48.substring(2);}if(arguments.length==2){_4a=_49;}else{_4a=d.hitch(_49,_4a);}this.getEventSource().addEventListener(_48,_4a,false);return [this,_48,_4a];},disconnect:function(_4b){this.getEventSource().removeEventListener(_4b[1],_4b[2],false);delete _4b[0];}};_4.extend(_7.Shape,_47);_4.extend(_7.Surface,_47);}if(g.loadAndSwitch==="svg"){g.switchTo("svg");delete g.loadAndSwitch;}})();}}};});