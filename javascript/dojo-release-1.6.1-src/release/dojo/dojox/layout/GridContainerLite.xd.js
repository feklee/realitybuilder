/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


realitybuilderDojo._xdResourceLoaded(function(_1,_2,_3){return {depends:[["provide","dojox.layout.GridContainerLite"],["require","dijit._Templated"],["require","dijit.layout._LayoutWidget"],["require","dojox.mdnd.AreaManager"],["require","dojox.mdnd.DropIndicator"],["require","dojox.mdnd.dropMode.OverDropMode"],["require","dojox.mdnd.AutoScroll"]],defineResource:function(_4,_5,_6){if(!_4._hasResource["dojox.layout.GridContainerLite"]){_4._hasResource["dojox.layout.GridContainerLite"]=true;_4.provide("dojox.layout.GridContainerLite");_4.require("dijit._Templated");_4.require("dijit.layout._LayoutWidget");_4.require("dojox.mdnd.AreaManager");_4.require("dojox.mdnd.DropIndicator");_4.require("dojox.mdnd.dropMode.OverDropMode");_4.require("dojox.mdnd.AutoScroll");_4.declare("dojox.layout.GridContainerLite",[_5.layout._LayoutWidget,_5._Templated],{autoRefresh:true,templateString:_4.cache("dojox.layout","resources/GridContainer.html","<div id=\"${id}\" class=\"gridContainer\" dojoAttachPoint=\"containerNode\" tabIndex=\"0\" dojoAttachEvent=\"onkeypress:_selectFocus\">\r\n\t<div dojoAttachPoint=\"gridContainerDiv\">\r\n\t\t<table class=\"gridContainerTable\" dojoAttachPoint=\"gridContainerTable\" cellspacing=\"0\" cellpadding=\"0\">\r\n\t\t\t<tbody>\r\n\t\t\t\t<tr dojoAttachPoint=\"gridNode\" >\r\n\t\t\t\t\t\r\n\t\t\t\t</tr>\r\n\t\t\t</tbody>\r\n\t\t</table>\r\n\t</div>\r\n</div>\r\n"),dragHandleClass:"dojoxDragHandle",nbZones:1,doLayout:true,isAutoOrganized:true,acceptTypes:[],colWidths:"",constructor:function(_7,_8){this.acceptTypes=(_7||{}).acceptTypes||["text"];this._disabled=true;},postCreate:function(){this.inherited(arguments);this._grid=[];this._createCells();this.subscribe("/dojox/mdnd/drop","resizeChildAfterDrop");this.subscribe("/dojox/mdnd/drag/start","resizeChildAfterDragStart");this._dragManager=_6.mdnd.areaManager();this._dragManager.autoRefresh=this.autoRefresh;this._dragManager.dragHandleClass=this.dragHandleClass;if(this.doLayout){this._border={"h":(_4.isIE)?_4._getBorderExtents(this.gridContainerTable).h:0,"w":(_4.isIE==6)?1:0};}else{_4.style(this.domNode,"overflowY","hidden");_4.style(this.gridContainerTable,"height","auto");}this.inherited(arguments);},startup:function(){if(this._started){return;}if(this.isAutoOrganized){this._organizeChildren();}else{this._organizeChildrenManually();}_4.forEach(this.getChildren(),function(_9){_9.startup();});if(this._isShown()){this.enableDnd();}this.inherited(arguments);},resizeChildAfterDrop:function(_a,_b,_c){if(this._disabled){return false;}if(_5.getEnclosingWidget(_b.node)==this){var _d=_5.byNode(_a);if(_d.resize&&_4.isFunction(_d.resize)){_d.resize();}_d.set("column",_a.parentNode.cellIndex);if(this.doLayout){var _e=this._contentBox.h,_f=_4.contentBox(this.gridContainerDiv).h;if(_f>=_e){_4.style(this.gridContainerTable,"height",(_e-this._border.h)+"px");}}return true;}return false;},resizeChildAfterDragStart:function(_10,_11,_12){if(this._disabled){return false;}if(_5.getEnclosingWidget(_11.node)==this){this._draggedNode=_10;if(this.doLayout){_4.marginBox(this.gridContainerTable,{"h":_4.contentBox(this.gridContainerDiv).h-this._border.h});}return true;}return false;},getChildren:function(){var _13=[];_4.forEach(this._grid,function(_14){_13=_13.concat(_4.query("> [widgetId]",_14.node).map(_5.byNode));});return _13;},_isShown:function(){if("open" in this){return this.open;}else{var _15=this.domNode;return (_15.style.display!="none")&&(_15.style.visibility!="hidden")&&!_4.hasClass(_15,"dijitHidden");}},layout:function(){if(this.doLayout){var _16=this._contentBox;_4.marginBox(this.gridContainerTable,{"h":_16.h-this._border.h});_4.contentBox(this.domNode,{"w":_16.w-this._border.w});}_4.forEach(this.getChildren(),function(_17){if(_17.resize&&_4.isFunction(_17.resize)){_17.resize();}});},onShow:function(){if(this._disabled){this.enableDnd();}},onHide:function(){if(!this._disabled){this.disableDnd();}},_createCells:function(){if(this.nbZones===0){this.nbZones=1;}var _18=this.acceptTypes.join(","),i=0;var _19=this.colWidths||[];var _1a=[];var _1b;var _1c=0;for(i=0;i<this.nbZones;i++){if(_1a.length<_19.length){_1c+=_19[i];_1a.push(_19[i]);}else{if(!_1b){_1b=(100-_1c)/(this.nbZones-i);}_1a.push(_1b);}}i=0;while(i<this.nbZones){this._grid.push({"node":_4.create("td",{"class":"gridContainerZone","accept":_18,"id":this.id+"_dz"+i,"style":{"width":_1a[i]+"%"}},this.gridNode)});i++;}},_getZonesAttr:function(){return _4.query(".gridContainerZone",this.containerNode);},enableDnd:function(){var m=this._dragManager;_4.forEach(this._grid,function(_1d){m.registerByNode(_1d.node);});m._dropMode.updateAreas(m._areaList);this._disabled=false;},disableDnd:function(){var m=this._dragManager;_4.forEach(this._grid,function(_1e){m.unregister(_1e.node);});m._dropMode.updateAreas(m._areaList);this._disabled=true;},_organizeChildren:function(){var _1f=_6.layout.GridContainerLite.superclass.getChildren.call(this);var _20=this.nbZones,_21=Math.floor(_1f.length/_20),mod=_1f.length%_20,i=0;for(var z=0;z<_20;z++){for(var r=0;r<_21;r++){this._insertChild(_1f[i],z);i++;}if(mod>0){try{this._insertChild(_1f[i],z);i++;}catch(e){console.error("Unable to insert child in GridContainer",e);}mod--;}else{if(_21===0){break;}}}},_organizeChildrenManually:function(){var _22=_6.layout.GridContainerLite.superclass.getChildren.call(this),_23=_22.length,_24;for(var i=0;i<_23;i++){_24=_22[i];try{this._insertChild(_24,_24.column-1);}catch(e){console.error("Unable to insert child in GridContainer",e);}}},_insertChild:function(_25,_26,p){var _27=this._grid[_26].node,_28=_27.childNodes.length;if(typeof (p)==undefined||p>_28){p=_28;}if(this._disabled){_4.place(_25.domNode,_27,p);_4.attr(_25.domNode,"tabIndex","0");}else{if(!_25.dragRestriction){this._dragManager.addDragItem(_27,_25.domNode,p,true);}else{_4.place(_25.domNode,_27,p);_4.attr(_25.domNode,"tabIndex","0");}}_25.set("column",_26);return _25;},removeChild:function(_29){if(this._disabled){this.inherited(arguments);}else{this._dragManager.removeDragItem(_29.domNode.parentNode,_29.domNode);}},addService:function(_2a,_2b,p){_4.deprecated("addService is deprecated.","Please use  instead.","Future");this.addChild(_2a,_2b,p);},addChild:function(_2c,_2d,p){_2c.domNode.id=_2c.id;_6.layout.GridContainerLite.superclass.addChild.call(this,_2c,0);if(_2d<0||_2d==undefined){_2d=0;}if(p<=0){p=0;}try{return this._insertChild(_2c,_2d,p);}catch(e){console.error("Unable to insert child in GridContainer",e);}return null;},_setColWidthsAttr:function(_2e){this.colWidths=_4.isString(_2e)?_2e.split(","):(_4.isArray(_2e)?_2e:[_2e]);if(this._started){this._updateColumnsWidth();}},_updateColumnsWidth:function(_2f){var _30=this._grid.length;var _31=this.colWidths||[];var _32=[];var _33;var _34=0;var i;for(i=0;i<_30;i++){if(_32.length<_31.length){_34+=_31[i]*1;_32.push(_31[i]);}else{if(!_33){_33=(100-_34)/(this.nbZones-i);if(_33<0){_33=100/this.nbZones;}}_32.push(_33);_34+=_33*1;}}if(_34>100){var _35=100/_34;for(i=0;i<_32.length;i++){_32[i]*=_35;}}for(i=0;i<_30;i++){this._grid[i].node.style.width=_32[i]+"%";}},_selectFocus:function(_36){if(this._disabled){return;}var key=_36.keyCode,k=_4.keys,_37=null,_38=_5.getFocus(),_39=_38.node,m=this._dragManager,_3a,i,j,r,_3b,_3c,_3d;if(_39==this.containerNode){_3c=this.gridNode.childNodes;switch(key){case k.DOWN_ARROW:case k.RIGHT_ARROW:_3a=false;for(i=0;i<_3c.length;i++){_3b=_3c[i].childNodes;for(j=0;j<_3b.length;j++){_37=_3b[j];if(_37!=null&&_37.style.display!="none"){_5.focus(_37);_4.stopEvent(_36);_3a=true;break;}}if(_3a){break;}}break;case k.UP_ARROW:case k.LEFT_ARROW:_3c=this.gridNode.childNodes;_3a=false;for(i=_3c.length-1;i>=0;i--){_3b=_3c[i].childNodes;for(j=_3b.length;j>=0;j--){_37=_3b[j];if(_37!=null&&_37.style.display!="none"){_5.focus(_37);_4.stopEvent(_36);_3a=true;break;}}if(_3a){break;}}break;}}else{if(_39.parentNode.parentNode==this.gridNode){var _3e=(key==k.UP_ARROW||key==k.LEFT_ARROW)?"lastChild":"firstChild";var pos=(key==k.UP_ARROW||key==k.LEFT_ARROW)?"previousSibling":"nextSibling";switch(key){case k.UP_ARROW:case k.DOWN_ARROW:_4.stopEvent(_36);_3a=false;var _3f=_39;while(!_3a){_3b=_3f.parentNode.childNodes;var num=0;for(i=0;i<_3b.length;i++){if(_3b[i].style.display!="none"){num++;}if(num>1){break;}}if(num==1){return;}if(_3f[pos]==null){_37=_3f.parentNode[_3e];}else{_37=_3f[pos];}if(_37.style.display==="none"){_3f=_37;}else{_3a=true;}}if(_36.shiftKey){var _40=_39.parentNode;for(i=0;i<this.gridNode.childNodes.length;i++){if(_40==this.gridNode.childNodes[i]){break;}}_3b=this.gridNode.childNodes[i].childNodes;for(j=0;j<_3b.length;j++){if(_37==_3b[j]){break;}}if(_4.isMoz||_4.isWebKit){i--;}_3d=_5.byNode(_39);if(!_3d.dragRestriction){r=m.removeDragItem(_40,_39);this.addChild(_3d,i,j);_4.attr(_39,"tabIndex","0");_5.focus(_39);}else{_4.publish("/dojox/layout/gridContainer/moveRestriction",[this]);}}else{_5.focus(_37);}break;case k.RIGHT_ARROW:case k.LEFT_ARROW:_4.stopEvent(_36);if(_36.shiftKey){var z=0;if(_39.parentNode[pos]==null){if(_4.isIE&&key==k.LEFT_ARROW){z=this.gridNode.childNodes.length-1;}}else{if(_39.parentNode[pos].nodeType==3){z=this.gridNode.childNodes.length-2;}else{for(i=0;i<this.gridNode.childNodes.length;i++){if(_39.parentNode[pos]==this.gridNode.childNodes[i]){break;}z++;}if(_4.isMoz||_4.isWebKit){z--;}}}_3d=_5.byNode(_39);var _41=_39.getAttribute("dndtype");if(_41==null){if(_3d&&_3d.dndType){_41=_3d.dndType.split(/\s*,\s*/);}else{_41=["text"];}}else{_41=_41.split(/\s*,\s*/);}var _42=false;for(i=0;i<this.acceptTypes.length;i++){for(j=0;j<_41.length;j++){if(_41[j]==this.acceptTypes[i]){_42=true;break;}}}if(_42&&!_3d.dragRestriction){var _43=_39.parentNode,_44=0;if(k.LEFT_ARROW==key){var t=z;if(_4.isMoz||_4.isWebKit){t=z+1;}_44=this.gridNode.childNodes[t].childNodes.length;}r=m.removeDragItem(_43,_39);this.addChild(_3d,z,_44);_4.attr(r,"tabIndex","0");_5.focus(r);}else{_4.publish("/dojox/layout/gridContainer/moveRestriction",[this]);}}else{var _45=_39.parentNode;while(_37===null){if(_45[pos]!==null&&_45[pos].nodeType!==3){_45=_45[pos];}else{if(pos==="previousSibling"){_45=_45.parentNode.childNodes[_45.parentNode.childNodes.length-1];}else{_45=(_4.isIE)?_45.parentNode.childNodes[0]:_45.parentNode.childNodes[1];}}_37=_45[_3e];if(_37&&_37.style.display=="none"){_3b=_37.parentNode.childNodes;var _46=null;if(pos=="previousSibling"){for(i=_3b.length-1;i>=0;i--){if(_3b[i].style.display!="none"){_46=_3b[i];break;}}}else{for(i=0;i<_3b.length;i++){if(_3b[i].style.display!="none"){_46=_3b[i];break;}}}if(!_46){_39=_37;_45=_39.parentNode;_37=null;}else{_37=_46;}}}_5.focus(_37);}break;}}}},destroy:function(){var m=this._dragManager;_4.forEach(this._grid,function(_47){m.unregister(_47.node);});this.inherited(arguments);}});_4.extend(_5._Widget,{column:"1",dragRestriction:false});}}};});