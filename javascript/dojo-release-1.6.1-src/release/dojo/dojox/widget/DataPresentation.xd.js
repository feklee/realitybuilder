/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


realitybuilderDojo._xdResourceLoaded(function(_1,_2,_3){return {depends:[["provide","dojox.widget.DataPresentation"],["require","dojox.grid.DataGrid"],["require","dojox.charting.Chart2D"],["require","dojox.charting.widget.Legend"],["require","dojox.charting.action2d.Tooltip"],["require","dojox.charting.action2d.Highlight"],["require","dojo.colors"],["require","dojo.data.ItemFileWriteStore"]],defineResource:function(_4,_5,_6){if(!_4._hasResource["dojox.widget.DataPresentation"]){_4._hasResource["dojox.widget.DataPresentation"]=true;_4.provide("dojox.widget.DataPresentation");_4.experimental("dojox.widget.DataPresentation");_4.require("dojox.grid.DataGrid");_4.require("dojox.charting.Chart2D");_4.require("dojox.charting.widget.Legend");_4.require("dojox.charting.action2d.Tooltip");_4.require("dojox.charting.action2d.Highlight");_4.require("dojo.colors");_4.require("dojo.data.ItemFileWriteStore");(function(){var _7=function(_8,_9,_a,_b){var _c=[];_c[0]={value:0,text:""};var _d=_8.length;if((_a!=="ClusteredBars")&&(_a!=="StackedBars")){var _e=_b.offsetWidth;var _f=(""+_8[0]).length*_8.length*7;if(_9==1){for(var z=1;z<500;++z){if((_f/z)<_e){break;}++_9;}}}for(var i=0;i<_d;i++){_c.push({value:i+1,text:(!_9||i%_9)?"":_8[i]});}_c.push({value:_d+1,text:""});return _c;};var _10=function(_11,_12){var _13={vertical:false,labels:_12,min:0,max:_12.length-1,majorTickStep:1,minorTickStep:1};if((_11==="ClusteredBars")||(_11==="StackedBars")){_13.vertical=true;}if((_11==="Lines")||(_11==="Areas")||(_11==="StackedAreas")){_13.min++;_13.max--;}return _13;};var _14=function(_15,_16,_17,_18){var _19={vertical:true,fixLower:"major",fixUpper:"major",natural:true};if(_16==="secondary"){_19.leftBottom=false;}if((_15==="ClusteredBars")||(_15==="StackedBars")){_19.vertical=false;}if(_17==_18){_19.min=_17-1;_19.max=_18+1;}return _19;};var _1a=function(_1b,_1c,_1d){var _1e={type:_1b,hAxis:"independent",vAxis:"dependent-"+_1c,gap:4,lines:false,areas:false,markers:false};if((_1b==="ClusteredBars")||(_1b==="StackedBars")){_1e.hAxis=_1e.vAxis;_1e.vAxis="independent";}if((_1b==="Lines")||(_1b==="Hybrid-Lines")||(_1b==="Areas")||(_1b==="StackedAreas")){_1e.lines=true;}if((_1b==="Areas")||(_1b==="StackedAreas")){_1e.areas=true;}if(_1b==="Lines"){_1e.markers=true;}if(_1b==="Hybrid-Lines"){_1e.shadows={dx:2,dy:2,dw:2};_1e.type="Lines";}if(_1b==="Hybrid-ClusteredColumns"){_1e.type="ClusteredColumns";}if(_1d){_1e.animate=_1d;}return _1e;};var _1f=function(_20,_21,_22,_23,_24,_25,_26,_27,_28,_29,_2a){var _2b=_21;if(!_2b){_20.innerHTML="";_2b=new _6.charting.Chart2D(_20);}if(_26){_26._clone=function(){var _2c=new _6.charting.Theme({chart:this.chart,plotarea:this.plotarea,axis:this.axis,series:this.series,marker:this.marker,antiAlias:this.antiAlias,assignColors:this.assignColors,assignMarkers:this.assigneMarkers,colors:_4.delegate(this.colors)});_2c.markers=this.markers;_2c._buildMarkerArray();return _2c;};_2b.setTheme(_26);}var _2d=_28.series_data[0].slice(0);if(_23){_2d.reverse();}var _2e=_7(_2d,_25,_22,_20);var _2f={};var _30=null;var _31=null;var _32={};for(var _33 in _2b.runs){_32[_33]=true;}var _34=_28.series_name.length;for(var i=0;i<_34;i++){if(_28.series_chart[i]&&(_28.series_data[i].length>0)){var _35=_22;var _36=_28.series_axis[i];if(_35=="Hybrid"){if(_28.series_charttype[i]=="line"){_35="Hybrid-Lines";}else{_35="Hybrid-ClusteredColumns";}}if(!_2f[_36]){_2f[_36]={};}if(!_2f[_36][_35]){var _37=_36+"-"+_35;_2b.addPlot(_37,_1a(_35,_36,_24));var _38={};if(typeof _27=="string"){_38.text=function(o){var _39=[o.element,o.run.name,_2d[o.index],((_35==="ClusteredBars")||(_35==="StackedBars"))?o.x:o.y];return _4.replace(_27,_39);};}else{if(typeof _27=="function"){_38.text=_27;}}new _6.charting.action2d.Tooltip(_2b,_37,_38);if(_35!=="Lines"&&_35!=="Hybrid-Lines"){new _6.charting.action2d.Highlight(_2b,_37);}_2f[_36][_35]=true;}var _3a=[];var _3b=_28.series_data[i].length;for(var j=0;j<_3b;j++){var val=_28.series_data[i][j];_3a.push(val);if(_30===null||val>_30){_30=val;}if(_31===null||val<_31){_31=val;}}if(_23){_3a.reverse();}var _3c={plot:_36+"-"+_35};if(_28.series_linestyle[i]){_3c.stroke={style:_28.series_linestyle[i]};}_2b.addSeries(_28.series_name[i],_3a,_3c);delete _32[_28.series_name[i]];}}for(_33 in _32){_2b.removeSeries(_33);}_2b.addAxis("independent",_10(_22,_2e));_2b.addAxis("dependent-primary",_14(_22,"primary",_31,_30));_2b.addAxis("dependent-secondary",_14(_22,"secondary",_31,_30));return _2b;};var _3d=function(_3e,_3f,_40,_41){var _42=_3f;if(!_42){_42=new _6.charting.widget.Legend({chart:_40,horizontal:_41},_3e);}else{_42.refresh();}return _42;};var _43=function(_44,_45,_46,_47,_48){var _49=_45||new _6.grid.DataGrid({},_44);_49.startup();_49.setStore(_46,_47,_48);var _4a=[];for(var ser=0;ser<_46.series_name.length;ser++){if(_46.series_grid[ser]&&(_46.series_data[ser].length>0)){_4a.push({field:"data."+ser,name:_46.series_name[ser],width:"auto",formatter:_46.series_gridformatter[ser]});}}_49.setStructure(_4a);return _49;};var _4b=function(_4c,_4d){if(_4d.title){_4c.innerHTML=_4d.title;}};var _4e=function(_4f,_50){if(_50.footer){_4f.innerHTML=_50.footer;}};var _51=function(_52,_53){var _54=_52;if(_53){var _55=_53.split(/[.\[\]]+/);for(var _56=0,l=_55.length;_56<l;_56++){if(_54){_54=_54[_55[_56]];}}}return _54;};_4.declare("dojox.widget.DataPresentation",null,{type:"chart",chartType:"clusteredBars",reverse:false,animate:null,labelMod:1,legendHorizontal:true,constructor:function(_57,_58){_4.mixin(this,_58);this.domNode=_4.byId(_57);this[this.type+"Node"]=this.domNode;if(typeof this.theme=="string"){this.theme=_4.getObject(this.theme);}this.chartNode=_4.byId(this.chartNode);this.legendNode=_4.byId(this.legendNode);this.gridNode=_4.byId(this.gridNode);this.titleNode=_4.byId(this.titleNode);this.footerNode=_4.byId(this.footerNode);if(this.legendVertical){this.legendHorizontal=!this.legendVertical;}if(this.url){this.setURL(null,null,this.refreshInterval);}else{if(this.data){this.setData(null,this.refreshInterval);}else{this.setStore();}}},setURL:function(url,_59,_5a){if(_5a){this.cancelRefresh();}this.url=url||this.url;this.urlContent=_59||this.urlContent;this.refreshInterval=_5a||this.refreshInterval;var me=this;_4.xhrGet({url:this.url,content:this.urlContent,handleAs:"json-comment-optional",load:function(_5b,_5c){me.setData(_5b);},error:function(xhr,_5d){if(me.urlError&&(typeof me.urlError=="function")){me.urlError(xhr,_5d);}}});if(_5a&&(this.refreshInterval>0)){this.refreshIntervalPending=setInterval(function(){me.setURL();},this.refreshInterval);}},setData:function(_5e,_5f){if(_5f){this.cancelRefresh();}this.data=_5e||this.data;this.refreshInterval=_5f||this.refreshInterval;var _60=(typeof this.series=="function")?this.series(this.data):this.series;var _61=[],_62=[],_63=[],_64=[],_65=[],_66=[],_67=[],_68=[],_69=[],_6a=0;for(var ser=0;ser<_60.length;ser++){_61[ser]=_51(this.data,_60[ser].datapoints);if(_61[ser]&&(_61[ser].length>_6a)){_6a=_61[ser].length;}_62[ser]=[];_63[ser]=_60[ser].name||(_60[ser].namefield?_51(this.data,_60[ser].namefield):null)||("series "+ser);_64[ser]=(_60[ser].chart!==false);_65[ser]=_60[ser].charttype||"bar";_66[ser]=_60[ser].linestyle;_67[ser]=_60[ser].axis||"primary";_68[ser]=(_60[ser].grid!==false);_69[ser]=_60[ser].gridformatter;}var _6b,_6c,_6d,_6e;var _6f=[];for(_6b=0;_6b<_6a;_6b++){_6c={index:_6b};for(ser=0;ser<_60.length;ser++){if(_61[ser]&&(_61[ser].length>_6b)){_6d=_51(_61[ser][_6b],_60[ser].field);if(_64[ser]){_6e=parseFloat(_6d);if(!isNaN(_6e)){_6d=_6e;}}_6c["data."+ser]=_6d;_62[ser].push(_6d);}}_6f.push(_6c);}if(_6a<=0){_6f.push({index:0});}var _70=new _4.data.ItemFileWriteStore({data:{identifier:"index",items:_6f}});if(this.data.title){_70.title=this.data.title;}if(this.data.footer){_70.footer=this.data.footer;}_70.series_data=_62;_70.series_name=_63;_70.series_chart=_64;_70.series_charttype=_65;_70.series_linestyle=_66;_70.series_axis=_67;_70.series_grid=_68;_70.series_gridformatter=_69;this.setPreparedStore(_70);if(_5f&&(this.refreshInterval>0)){var me=this;this.refreshIntervalPending=setInterval(function(){me.setData();},this.refreshInterval);}},refresh:function(){if(this.url){this.setURL(this.url,this.urlContent,this.refreshInterval);}else{if(this.data){this.setData(this.data,this.refreshInterval);}}},cancelRefresh:function(){if(this.refreshIntervalPending){clearInterval(this.refreshIntervalPending);this.refreshIntervalPending=undefined;}},setStore:function(_71,_72,_73){this.setPreparedStore(_71,_72,_73);},setPreparedStore:function(_74,_75,_76){this.preparedstore=_74||this.store;this.query=_75||this.query;this.queryOptions=_76||this.queryOptions;if(this.preparedstore){if(this.chartNode){this.chartWidget=_1f(this.chartNode,this.chartWidget,this.chartType,this.reverse,this.animate,this.labelMod,this.theme,this.tooltip,this.preparedstore,this.query,this,_76);this.renderChartWidget();}if(this.legendNode){this.legendWidget=_3d(this.legendNode,this.legendWidget,this.chartWidget,this.legendHorizontal);}if(this.gridNode){this.gridWidget=_43(this.gridNode,this.gridWidget,this.preparedstore,this.query,this.queryOptions);this.renderGridWidget();}if(this.titleNode){_4b(this.titleNode,this.preparedstore);}if(this.footerNode){_4e(this.footerNode,this.preparedstore);}}},renderChartWidget:function(){if(this.chartWidget){this.chartWidget.render();}},renderGridWidget:function(){if(this.gridWidget){this.gridWidget.render();}},getChartWidget:function(){return this.chartWidget;},getGridWidget:function(){return this.gridWidget;},destroy:function(){this.cancelRefresh();if(this.chartWidget){this.chartWidget.destroy();delete this.chartWidget;}if(this.legendWidget){delete this.legendWidget;}if(this.gridWidget){delete this.gridWidget;}if(this.chartNode){this.chartNode.innerHTML="";}if(this.legendNode){this.legendNode.innerHTML="";}if(this.gridNode){this.gridNode.innerHTML="";}if(this.titleNode){this.titleNode.innerHTML="";}if(this.footerNode){this.footerNode.innerHTML="";}}});})();}}};});