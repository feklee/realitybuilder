/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


realityBuilderDojo._xdResourceLoaded(function(_1,_2,_3){return {depends:[["provide","realityBuilder.BlockProperties"]],defineResource:function(_4,_5,_6){if(!_4._hasResource["realityBuilder.BlockProperties"]){_4._hasResource["realityBuilder.BlockProperties"]=true;_4.provide("realityBuilder.BlockProperties");_4.declare("realityBuilder.BlockProperties",null,{_versionOnServer:"-1",_congruencyA:null,_blockPositionSpacingXY:null,_blockPositionSpacingZ:null,_outlineBXY:null,_rotatedOutlinesBXY:null,_collisionOffsetsListBXY:null,_rotatedCollisionOffsetsListsBXY:null,_attachmentOffsetsListB:null,_rotatedAttachmentOffsetsListsB:null,_rotCenterBXY:null,_backgroundAlpha:null,versionOnServer:function(){return this._versionOnServer;},isInitializedWithServerData:function(){return this._versionOnServer!=="-1";},_rotateOutlineBXY:function(a){var _7=this;return _4.map(this._outlineBXY,function(_8){return realityBuilder.util.rotatePointBXY(_8,_7._rotCenterBXY,a);});},_updateRotatedOutlinesBXY:function(){var a;this._rotatedOutlinesBXY=[];for(a=0;a<4;a+=1){this._rotatedOutlinesBXY.push(this._rotateOutlineBXY(a));}},_congruencyOffsetBXY:function(a){if(a===0){return [1,0];}else{return [0,1];}},_withCongruencyOffsetsAddedBXY:function(_9,a){var _a=this._congruencyOffsetBXY(a);return _4.map(_9,function(_b){return realityBuilder.util.addVectorsBXY(_b,_a);});},_completeCollisionOffsetsListBXY:function(){var _c=this._collisionOffsetsListBXY;_c.push(this._withCongruencyOffsetsAddedBXY(_c[0],0));_c.push(this._withCongruencyOffsetsAddedBXY(_c[1],1));},_rotateCollisionOffsetsBXY:function(_d,a){var _e=realityBuilder.util;return _4.map(_d,function(_f){return _e.rotatePointBXY(_f,[0,0],a);});},_rotateCollisionOffsetsListBXY:function(a1){var a2,_10,tmp=[];for(a2=0;a2<4;a2+=1){_10=this._collisionOffsetsListBXY[a2];tmp.push(this._rotateCollisionOffsetsBXY(_10,a1));}return tmp;},_updateRotatedCollisionOffsetsListsBXY:function(){var a1,tmp;this._rotatedCollisionOffsetsListsBXY=[];for(a1=0;a1<4;a1+=1){tmp=this._rotateCollisionOffsetsListBXY(a1);this._rotatedCollisionOffsetsListsBXY.push(tmp);}},_rotateAttachmentOffsetB:function(_11,a){var _12,_13,_14,_15;_15=realityBuilder.util;_12=[_11[0],_11[1]];_13=_15.rotatePointBXY(_12,[0,0],a);return [_13[0],_13[1],_11[2]];},_rotateAttachmentOffsetsB:function(_16,a){var _17=this;return _4.map(_16,function(_18){return _17._rotateAttachmentOffsetB(_18,a);});},_rotateAttachmentOffsetsListB:function(a1){var a2,_19,tmp=[];for(a2=0;a2<this._congruencyA;a2+=1){_19=this._attachmentOffsetsListB[a2];tmp.push(this._rotateAttachmentOffsetsB(_19,a1));}return tmp;},_updateRotatedAttachmentOffsetsListsB:function(){var a1,tmp;this._rotatedAttachmentOffsetsListsB=[];for(a1=0;a1<this._congruencyA;a1+=1){tmp=this._rotateAttachmentOffsetsListB(a1);this._rotatedAttachmentOffsetsListsB.push(tmp);}},updateWithServerData:function(_1a){if(this._versionOnServer!==_1a.version){this._versionOnServer=_1a.version;this._congruencyA=_1a.congruencyA;this._positionSpacingXY=_1a.positionSpacingXY;this._positionSpacingZ=_1a.positionSpacingZ;this._outlineBXY=_1a.outlineBXY;this._collisionOffsetsListBXY=_1a.collisionOffsetsListBXY;this._attachmentOffsetsListB=_1a.attachmentOffsetsListB;this._rotCenterBXY=_1a.rotCenterBXY;this._backgroundAlpha=_1a.backgroundAlpha;this._updateRotatedOutlinesBXY();this._completeCollisionOffsetsListBXY();this._updateRotatedCollisionOffsetsListsBXY();this._updateRotatedAttachmentOffsetsListsB();_4.publish("realityBuilder/BlockProperties/changed");}},positionSpacingXY:function(){return this._positionSpacingXY;},positionSpacingZ:function(){return this._positionSpacingZ;},rotatedOutlineBXY:function(a){return this._rotatedOutlinesBXY[a%4];},rotatedCollisionOffsetsBXY:function(_1b,_1c){var _1d,_1e,a1,a2;a1=_1b.a()%4;a2=_1c.a()%4;_1d=this._rotatedCollisionOffsetsListsBXY[a1];_1e=(4+a2-a1)%4;return _1d[_1e];},rotatedAttachmentOffsetsB:function(_1f,_20){var _21,_22,a1,a2;a1=_1f.a()%this._congruencyA;a2=_20.a()%this._congruencyA;_21=this._rotatedAttachmentOffsetsListsB[a1];_22=(this._congruencyA+a2-a1)%this._congruencyA;return _21[_22];},backgroundAlpha:function(){return this._backgroundAlpha;}});}}};});