/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


realityBuilderDojo._xdResourceLoaded(function(_1,_2,_3){return {depends:[["provide","dojo.back"]],defineResource:function(_4,_5,_6){if(!_4._hasResource["dojo.back"]){_4._hasResource["dojo.back"]=true;_4.provide("dojo.back");_4.getObject("back",true,_4);(function(){var _7=_4.back,_8=_7.getHash=function(){var h=window.location.hash;if(h.charAt(0)=="#"){h=h.substring(1);}return _4.isMozilla?h:decodeURIComponent(h);},_9=_7.setHash=function(h){if(!h){h="";}window.location.hash=encodeURIComponent(h);_a=history.length;};var _b=(typeof (window)!=="undefined")?window.location.href:"";var _c=(typeof (window)!=="undefined")?_8():"";var _d=null;var _e=null;var _f=null;var _10=null;var _11=[];var _12=[];var _13=false;var _14=false;var _a;function _15(){var _16=_12.pop();if(!_16){return;}var _17=_12[_12.length-1];if(!_17&&_12.length==0){_17=_d;}if(_17){if(_17.kwArgs["back"]){_17.kwArgs["back"]();}else{if(_17.kwArgs["backButton"]){_17.kwArgs["backButton"]();}else{if(_17.kwArgs["handle"]){_17.kwArgs.handle("back");}}}}_11.push(_16);};_7.goBack=_15;function _18(){var _19=_11.pop();if(!_19){return;}if(_19.kwArgs["forward"]){_19.kwArgs.forward();}else{if(_19.kwArgs["forwardButton"]){_19.kwArgs.forwardButton();}else{if(_19.kwArgs["handle"]){_19.kwArgs.handle("forward");}}}_12.push(_19);};_7.goForward=_18;function _1a(url,_1b,_1c){return {"url":url,"kwArgs":_1b,"urlHash":_1c};};function _1d(url){var _1e=url.split("?");if(_1e.length<2){return null;}else{return _1e[1];}};function _1f(){var url=(_4.config["dojoIframeHistoryUrl"]||_4.moduleUrl("dojo","resources/iframe_history.html"))+"?"+(new Date()).getTime();_13=true;if(_10){_4.isWebKit?_10.location=url:window.frames[_10.name].location=url;}else{}return url;};function _20(){if(!_14){var hsl=_12.length;var _21=_8();if((_21===_c||window.location.href==_b)&&(hsl==1)){_15();return;}if(_11.length>0){if(_11[_11.length-1].urlHash===_21){_18();return;}}if((hsl>=2)&&(_12[hsl-2])){if(_12[hsl-2].urlHash===_21){_15();return;}}}};_7.init=function(){if(_4.byId("dj_history")){return;}var src=_4.config["dojoIframeHistoryUrl"]||_4.moduleUrl("dojo","resources/iframe_history.html");if(_4._postLoad){console.error("dojo.back.init() must be called before the DOM has loaded. "+"If using xdomain loading or djConfig.debugAtAllCosts, include dojo.back "+"in a build layer.");}else{document.write("<iframe style=\"border:0;width:1px;height:1px;position:absolute;visibility:hidden;bottom:0;right:0;\" name=\"dj_history\" id=\"dj_history\" src=\""+src+"\"></iframe>");}};_7.setInitialState=function(_22){_d=_1a(_b,_22,_c);};_7.addToHistory=function(_23){_11=[];var _24=null;var url=null;if(!_10){if(_4.config["useXDomain"]&&!_4.config["dojoIframeHistoryUrl"]){console.warn("dojo.back: When using cross-domain Dojo builds,"+" please save iframe_history.html to your domain and set djConfig.dojoIframeHistoryUrl"+" to the path on your domain to iframe_history.html");}_10=window.frames["dj_history"];}if(!_f){_f=_4.create("a",{style:{display:"none"}},_4.body());}if(_23["changeUrl"]){_24=""+((_23["changeUrl"]!==true)?_23["changeUrl"]:(new Date()).getTime());if(_12.length==0&&_d.urlHash==_24){_d=_1a(url,_23,_24);return;}else{if(_12.length>0&&_12[_12.length-1].urlHash==_24){_12[_12.length-1]=_1a(url,_23,_24);return;}}_14=true;setTimeout(function(){_9(_24);_14=false;},1);_f.href=_24;if(_4.isIE){url=_1f();var _25=_23["back"]||_23["backButton"]||_23["handle"];var tcb=function(_26){if(_8()!=""){setTimeout(function(){_9(_24);},1);}_25.apply(this,[_26]);};if(_23["back"]){_23.back=tcb;}else{if(_23["backButton"]){_23.backButton=tcb;}else{if(_23["handle"]){_23.handle=tcb;}}}var _27=_23["forward"]||_23["forwardButton"]||_23["handle"];var tfw=function(_28){if(_8()!=""){_9(_24);}if(_27){_27.apply(this,[_28]);}};if(_23["forward"]){_23.forward=tfw;}else{if(_23["forwardButton"]){_23.forwardButton=tfw;}else{if(_23["handle"]){_23.handle=tfw;}}}}else{if(!_4.isIE){if(!_e){_e=setInterval(_20,200);}}}}else{url=_1f();}_12.push(_1a(url,_23,_24));};_7._iframeLoaded=function(evt,_29){var _2a=_1d(_29.href);if(_2a==null){if(_12.length==1){_15();}return;}if(_13){_13=false;return;}if(_12.length>=2&&_2a==_1d(_12[_12.length-2].url)){_15();}else{if(_11.length>0&&_2a==_1d(_11[_11.length-1].url)){_18();}}};})();}}};});