/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


realityBuilderDojo._xdResourceLoaded(function(_1,_2,_3){return {depends:[["provide","dojox.calc.Standard"],["require","dijit._Templated"],["require","dojox.math._base"],["require","dijit.dijit"],["require","dijit.Menu"],["require","dijit.form.DropDownButton"],["require","dijit.TooltipDialog"],["require","dijit.form.TextBox"],["require","dijit.form.Button"],["require","dojox.calc._Executor"]],defineResource:function(_4,_5,_6){if(!_4._hasResource["dojox.calc.Standard"]){_4._hasResource["dojox.calc.Standard"]=true;_4.provide("dojox.calc.Standard");_4.require("dijit._Templated");_4.require("dojox.math._base");_4.require("dijit.dijit");_4.require("dijit.Menu");_4.require("dijit.form.DropDownButton");_4.require("dijit.TooltipDialog");_4.require("dijit.form.TextBox");_4.require("dijit.form.Button");_4.require("dojox.calc._Executor");_4.experimental("dojox.calc.Standard");_4.declare("dojox.calc.Standard",[_5._Widget,_5._Templated],{templateString:_4.cache("dojox.calc","templates/Standard.html","<div class=\"dijitReset dijitInline dojoxCalc\"\r\n><table class=\"dijitReset dijitInline dojoxCalcLayout\" dojoAttachPoint=\"calcTable\" rules=\"none\" cellspacing=0 cellpadding=0 border=0>\r\n\t<tr\r\n\t\t><td colspan=\"4\" class=\"dojoxCalcInputContainer\"\r\n\t\t\t><input dojoType=\"dijit.form.TextBox\" dojoAttachEvent=\"onBlur:onBlur,onKeyPress:onKeyPress\" dojoAttachPoint='textboxWidget'\r\n\t\t/></td\r\n\t></tr>\r\n\t<tr>\r\n\t\t<td class=\"dojoxCalcButtonContainer\">\r\n\t\t\t<button dojoType=\"dijit.form.Button\" dojoAttachPoint=\"seven\" label=\"7\" value='7' dojoAttachEvent='onClick:insertText' />\r\n\t\t</td>\r\n\t\t<td class=\"dojoxCalcButtonContainer\">\r\n\t\t\t<button dojoType=\"dijit.form.Button\" dojoAttachPoint=\"eight\" label=\"8\" value='8' dojoAttachEvent='onClick:insertText' />\r\n\t\t</td>\r\n\t\t<td class=\"dojoxCalcButtonContainer\">\r\n\t\t\t<button dojoType=\"dijit.form.Button\" dojoAttachPoint=\"nine\" label=\"9\" value='9' dojoAttachEvent='onClick:insertText' />\r\n\t\t</td>\r\n\t\t<td class=\"dojoxCalcButtonContainer\">\r\n\t\t\t<button dojoType=\"dijit.form.Button\" dojoAttachPoint=\"divide\" label=\"/\" value='/' dojoAttachEvent='onClick:insertOperator' />\r\n\t\t</td>\r\n\t</tr>\r\n\t<tr>\r\n\t\t<td class=\"dojoxCalcButtonContainer\">\r\n\t\t\t<button dojoType=\"dijit.form.Button\" dojoAttachPoint=\"four\" label=\"4\" value='4' dojoAttachEvent='onClick:insertText' />\r\n\t\t</td>\r\n\t\t<td class=\"dojoxCalcButtonContainer\">\r\n\t\t\t<button dojoType=\"dijit.form.Button\" dojoAttachPoint=\"five\" label=\"5\" value='5' dojoAttachEvent='onClick:insertText' />\r\n\t\t</td>\r\n\t\t<td class=\"dojoxCalcButtonContainer\">\r\n\t\t\t<button dojoType=\"dijit.form.Button\" dojoAttachPoint=\"six\" label=\"6\" value='6' dojoAttachEvent='onClick:insertText' />\r\n\t\t</td>\r\n\t\t<td class=\"dojoxCalcButtonContainer\">\r\n\t\t\t<button dojoType=\"dijit.form.Button\" dojoAttachPoint=\"multiply\" label=\"*\" value='*' dojoAttachEvent='onClick:insertOperator' />\r\n\t\t</td>\r\n\t</tr>\r\n\t<tr>\r\n\t\t<td class=\"dojoxCalcButtonContainer\">\r\n\t\t\t<button dojoType=\"dijit.form.Button\" dojoAttachPoint=\"one\" label=\"1\" value='1' dojoAttachEvent='onClick:insertText' />\r\n\t\t</td>\r\n\t\t<td class=\"dojoxCalcButtonContainer\">\r\n\t\t\t<button dojoType=\"dijit.form.Button\" dojoAttachPoint=\"two\" label=\"2\" value='2' dojoAttachEvent='onClick:insertText' />\r\n\t\t</td>\r\n\t\t<td class=\"dojoxCalcButtonContainer\">\r\n\t\t\t<button dojoType=\"dijit.form.Button\" dojoAttachPoint=\"three\" label=\"3\" value='3' dojoAttachEvent='onClick:insertText' />\r\n\t\t</td>\r\n\t\t<td class=\"dojoxCalcButtonContainer\">\r\n\t\t\t<button dojoType=\"dijit.form.Button\" dojoAttachPoint=\"add\" label=\"+\" value='+' dojoAttachEvent='onClick:insertOperator' />\r\n\t\t</td>\r\n\t</tr>\r\n\t<tr>\r\n\t\t<td class=\"dojoxCalcButtonContainer\">\r\n\t\t\t<button dojoType=\"dijit.form.Button\" dojoAttachPoint=\"decimal\" label=\".\" value='.' dojoAttachEvent='onClick:insertText' />\r\n\t\t</td>\r\n\t\t<td class=\"dojoxCalcButtonContainer\">\r\n\t\t\t<button dojoType=\"dijit.form.Button\" dojoAttachPoint=\"zero\" label=\"0\" value='0' dojoAttachEvent='onClick:insertText' />\r\n\t\t</td>\r\n\t\t<td class=\"dojoxCalcButtonContainer\">\r\n\t\t\t<button dojoType=\"dijit.form.Button\" dojoAttachPoint=\"equals\" label=\"x=y\" value='=' dojoAttachEvent='onClick:insertText' />\r\n\t\t</td>\r\n\t\t<td class=\"dojoxCalcMinusButtonContainer\">\r\n\t\t\t<span dojoType=\"dijit.form.ComboButton\" dojoAttachPoint=\"subtract\" label='-' value='-' dojoAttachEvent='onClick:insertOperator'>\r\n\r\n\t\t\t\t<div dojoType=\"dijit.Menu\" style=\"display:none;\">\r\n\t\t\t\t\t<div dojoType=\"dijit.MenuItem\" dojoAttachEvent=\"onClick:insertMinus\">\r\n\t\t\t\t\t\t(-)\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</span>\r\n\t\t</td>\r\n\t</tr>\r\n\t<tr>\r\n\t\t<td class=\"dojoxCalcButtonContainer\">\r\n\t\t\t<button dojoType=\"dijit.form.Button\" dojoAttachPoint=\"clear\" label=\"Clear\" dojoAttachEvent='onClick:clearText' />\r\n\t\t</td>\r\n\t\t<td class=\"dojoxCalcButtonContainer\">\r\n\t\t\t<button dojoType=\"dijit.form.Button\" dojoAttachPoint=\"sqrt\" label=\"&#x221A;\" value=\"&#x221A;\" dojoAttachEvent='onClick:insertText' />\r\n\t\t</td>\r\n\t\t<td class=\"dojoxCalcButtonContainer\">\r\n\t\t\t<button dojoType=\"dijit.form.Button\" dojoAttachPoint=\"power\" label=\"^\" value=\"^\" dojoAttachEvent='onClick:insertOperator' />\r\n\t\t</td>\r\n\t\t<td class=\"dojoxCalcButtonContainer\">\r\n\t\t\t<button dojoType=\"dijit.form.Button\" dojoAttachPoint=\"comma\" label=\",\" value=',' dojoAttachEvent='onClick:insertText' />\r\n\t\t</td>\r\n\t</tr>\r\n\t<tr>\r\n\t\t<td class=\"dojoxCalcButtonContainer\">\r\n\t\t\t<button dojoType=\"dijit.form.Button\" dojoAttachPoint=\"AnsButton\" label=\"Ans\" value=\"Ans\" dojoAttachEvent='onClick:insertText' />\r\n\t\t</td>\r\n\t\t<td class=\"dojoxCalcButtonContainer\">\r\n\t\t\t<button dojoType=\"dijit.form.Button\" dojoAttachPoint=\"LeftParenButton\" label=\"(\" value=\"(\" dojoAttachEvent='onClick:insertText' />\r\n\t\t</td>\r\n\t\t<td class=\"dojoxCalcButtonContainer\">\r\n\t\t\t<button dojoType=\"dijit.form.Button\" dojoAttachPoint=\"RightParenButton\" label=\")\" value=\")\" dojoAttachEvent='onClick:insertText' />\r\n\t\t</td>\r\n\t\t<td class=\"dojoxCalcButtonContainer\">\r\n\t\t\t<button dojoType=\"dijit.form.Button\" dojoAttachPoint=\"enter\" label=\"Enter\" dojoAttachEvent='onClick:parseTextbox' />\r\n\t\t</td>\r\n\t</tr>\r\n</table>\r\n<span dojoAttachPoint=\"executor\" dojoType=\"dojox.calc._Executor\" dojoAttachEvent=\"onLoad:executorLoaded\"></span>\r\n</div>\r\n"),readStore:null,writeStore:null,functions:[],widgetsInTemplate:true,executorLoaded:function(){_4.addOnLoad(_4.hitch(this,function(){this.loadStore(this.readStore,true);this.loadStore(this.writeStore);}));},saveFunction:function(_7,_8,_9){this.functions[_7]=this.executor.normalizedFunction(_7,_8,_9);this.functions[_7].args=_8;this.functions[_7].body=_9;},loadStore:function(_a,_b){function _c(_d){for(var i=0;i<_d.length;i++){this.saveFunction(_d[i].name[0],_d[i].args[0],_d[i].body[0]);}};function _e(_f){for(var i=0;i<_f.length;i++){this.executor.normalizedFunction(_f[i].name[0],_f[i].args[0],_f[i].body[0]);}};if(_a==null){return;}if(_b){_a.fetch({onComplete:_4.hitch(this,_e),onError:function(_10){console.error(_10);}});}else{_a.fetch({onComplete:_4.hitch(this,_c),onError:function(_11){console.error(_11);}});}},parseTextbox:function(){var _12=this.textboxWidget.textbox.value;if(_12==""&&this.commandList.length>0){this.setTextboxValue(this.textboxWidget,this.commandList[this.commandList.length-1]);_12=this.textboxWidget.textbox.value;}if(_12!=""){var ans=this.executor.eval(_12);if((typeof ans=="number"&&isNaN(ans))){if(this.commandList.length==0||this.commandList[this.commandList.length-1]!=_12){this.commandList.push(_12);}this.print(_12,false);this.print("Not a Number",true);}else{if(((typeof ans=="object"&&"length" in ans)||typeof ans!="object")&&typeof ans!="function"&&ans!=null){this.executor.eval("Ans="+ans);if(this.commandList.length==0||this.commandList[this.commandList.length-1]!=_12){this.commandList.push(_12);}this.print(_12,false);this.print(ans,true);}}this.commandIndex=this.commandList.length-1;if(this.hasDisplay){this.displayBox.scrollTop=this.displayBox.scrollHeight;}_5.selectInputText(this.textboxWidget.textbox);}else{this.textboxWidget.focus();}},cycleCommands:function(_13,_14,_15){if(_13==-1||this.commandList.length==0){return;}var _16=_15.charOrCode;if(_16==_4.keys.UP_ARROW){this.cycleCommandUp();}else{if(_16==_4.keys.DOWN_ARROW){this.cycleCommandDown();}}},cycleCommandUp:function(){if(this.commandIndex-1<0){this.commandIndex=0;}else{this.commandIndex--;}this.setTextboxValue(this.textboxWidget,this.commandList[this.commandIndex]);},cycleCommandDown:function(){if(this.commandIndex+1>=this.commandList.length){this.commandIndex=this.commandList.length;this.setTextboxValue(this.textboxWidget,"");}else{this.commandIndex++;this.setTextboxValue(this.textboxWidget,this.commandList[this.commandIndex]);}},onBlur:function(){if(_4.isIE){var tr=_4.doc.selection.createRange().duplicate();var _17=tr.text||"";var ntr=this.textboxWidget.textbox.createTextRange();tr.move("character",0);ntr.move("character",0);try{ntr.setEndPoint("EndToEnd",tr);this.textboxWidget.textbox.selectionEnd=(this.textboxWidget.textbox.selectionStart=String(ntr.text).replace(/\r/g,"").length)+_17.length;}catch(e){}}},onKeyPress:function(_18){if(_18.charOrCode==_4.keys.ENTER){this.parseTextbox();_4.stopEvent(_18);}else{if(_18.charOrCode=="!"||_18.charOrCode=="^"||_18.charOrCode=="*"||_18.charOrCode=="/"||_18.charOrCode=="-"||_18.charOrCode=="+"){if(_4.isIE){var tr=_4.doc.selection.createRange().duplicate();var _19=tr.text||"";var ntr=this.textboxWidget.textbox.createTextRange();tr.move("character",0);ntr.move("character",0);try{ntr.setEndPoint("EndToEnd",tr);this.textboxWidget.textbox.selectionEnd=(this.textboxWidget.textbox.selectionStart=String(ntr.text).replace(/\r/g,"").length)+_19.length;}catch(e){}}if(this.textboxWidget.get("value")==""){this.setTextboxValue(this.textboxWidget,"Ans");}else{if(this.putInAnsIfTextboxIsHighlighted(this.textboxWidget.textbox,_18.charOrCode)){this.setTextboxValue(this.textboxWidget,"Ans");_5.selectInputText(this.textboxWidget.textbox,this.textboxWidget.textbox.value.length,this.textboxWidget.textbox.value.length);}}}}},insertMinus:function(){this.insertText("-");},print:function(_1a,_1b){var t="<span style='display:block;";if(_1b){t+="text-align:right;'>";}else{t+="text-align:left;'>";}t+=_1a+"<br></span>";if(this.hasDisplay){this.displayBox.innerHTML+=t;}else{this.setTextboxValue(this.textboxWidget,_1a);}},setTextboxValue:function(_1c,val){_1c.set("value",val);},putInAnsIfTextboxIsHighlighted:function(_1d){if(typeof _1d.selectionStart=="number"){if(_1d.selectionStart==0&&_1d.selectionEnd==_1d.value.length){return true;}}else{if(document.selection){var _1e=document.selection.createRange();if(_1d.value==_1e.text){return true;}}}return false;},clearText:function(){if(this.hasDisplay&&this.textboxWidget.get("value")==""){this.displayBox.innerHTML="";}else{this.setTextboxValue(this.textboxWidget,"");}this.textboxWidget.focus();},insertOperator:function(_1f){if(typeof _1f=="object"){_1f=_1f=_5.getEnclosingWidget(_1f["target"]).value;}if(this.textboxWidget.get("value")==""||this.putInAnsIfTextboxIsHighlighted(this.textboxWidget.textbox)){_1f="Ans"+_1f;}this.insertText(_1f);},insertText:function(_20){setTimeout(_4.hitch(this,function(){var _21=this.textboxWidget.textbox;if(_21.value==""){_21.selectionStart=0;_21.selectionEnd=0;}if(typeof _20=="object"){_20=_20=_5.getEnclosingWidget(_20["target"]).value;}var _22=_21.value.replace(/\r/g,"");if(typeof _21.selectionStart=="number"){var pos=_21.selectionStart;var cr=0;if(navigator.userAgent.indexOf("Opera")!=-1){cr=(_21.value.substring(0,pos).match(/\r/g)||[]).length;}_21.value=_22.substring(0,_21.selectionStart-cr)+_20+_22.substring(_21.selectionEnd-cr);_21.focus();pos+=_20.length;_5.selectInputText(this.textboxWidget.textbox,pos,pos);}else{if(document.selection){if(this.handle){clearTimeout(this.handle);this.handle=null;}_21.focus();this.handle=setTimeout(function(){var _23=document.selection.createRange();_23.text=_20;_23.select();this.handle=null;},0);}}}),0);},hasDisplay:false,postCreate:function(){this.handle=null;this.commandList=[];this.commandIndex=0;if(this.displayBox){this.hasDisplay=true;}if(this.toFracButton&&!_6.calc.toFrac){_4.style(this.toFracButton.domNode,{visibility:"hidden"});}if(this.functionMakerButton&&!_6.calc.FuncGen){_4.style(this.functionMakerButton.domNode,{visibility:"hidden"});}if(this.grapherMakerButton&&!_6.calc.Grapher){_4.style(this.grapherMakerButton.domNode,{visibility:"hidden"});}this._connects.push(_5.typematic.addKeyListener(this.textboxWidget.textbox,{charOrCode:_4.keys.UP_ARROW,shiftKey:false,metaKey:false,ctrlKey:false},this,this.cycleCommands,200,200));this._connects.push(_5.typematic.addKeyListener(this.textboxWidget.textbox,{charOrCode:_4.keys.DOWN_ARROW,shiftKey:false,metaKey:false,ctrlKey:false},this,this.cycleCommands,200,200));this.startup();}});}}};});