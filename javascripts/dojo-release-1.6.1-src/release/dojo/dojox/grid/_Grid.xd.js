/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


realityBuilderDojo._xdResourceLoaded(function(_1,_2,_3){return {depends:[["provide","dojox.grid._Grid"],["require","dijit.dijit"],["require","dijit.Menu"],["require","dojox.html.metrics"],["require","dojox.grid.util"],["require","dojox.grid._Scroller"],["require","dojox.grid._Layout"],["require","dojox.grid._View"],["require","dojox.grid._ViewManager"],["require","dojox.grid._RowManager"],["require","dojox.grid._FocusManager"],["require","dojox.grid._EditManager"],["require","dojox.grid.Selection"],["require","dojox.grid._RowSelector"],["require","dojox.grid._Events"],["requireLocalization","dijit","loading",null,"",""]],defineResource:function(_4,_5,_6){if(!_4._hasResource["dojox.grid._Grid"]){_4._hasResource["dojox.grid._Grid"]=true;_4.provide("dojox.grid._Grid");_4.require("dijit.dijit");_4.require("dijit.Menu");_4.require("dojox.html.metrics");_4.require("dojox.grid.util");_4.require("dojox.grid._Scroller");_4.require("dojox.grid._Layout");_4.require("dojox.grid._View");_4.require("dojox.grid._ViewManager");_4.require("dojox.grid._RowManager");_4.require("dojox.grid._FocusManager");_4.require("dojox.grid._EditManager");_4.require("dojox.grid.Selection");_4.require("dojox.grid._RowSelector");_4.require("dojox.grid._Events");(function(){if(!_4.isCopyKey){_4.isCopyKey=_4.dnd.getCopyKeyState;}_4.declare("dojox.grid._Grid",[_5._Widget,_5._Templated,_6.grid._Events],{templateString:"<div hidefocus=\"hidefocus\" role=\"grid\" dojoAttachEvent=\"onmouseout:_mouseOut\">\r\n\t<div class=\"dojoxGridMasterHeader\" dojoAttachPoint=\"viewsHeaderNode\" role=\"presentation\"></div>\r\n\t<div class=\"dojoxGridMasterView\" dojoAttachPoint=\"viewsNode\" role=\"presentation\"></div>\r\n\t<div class=\"dojoxGridMasterMessages\" style=\"display: none;\" dojoAttachPoint=\"messagesNode\"></div>\r\n\t<span dojoAttachPoint=\"lastFocusNode\" tabindex=\"0\"></span>\r\n</div>\r\n",classTag:"dojoxGrid",rowCount:5,keepRows:75,rowsPerPage:25,autoWidth:false,initialWidth:"",autoHeight:"",rowHeight:0,autoRender:true,defaultHeight:"15em",height:"",structure:null,elasticView:-1,singleClickEdit:false,selectionMode:"extended",rowSelector:"",columnReordering:false,headerMenu:null,placeholderLabel:"GridColumns",selectable:false,_click:null,loadingMessage:"<span class='dojoxGridLoading'>${loadingState}</span>",errorMessage:"<span class='dojoxGridError'>${errorState}</span>",noDataMessage:"",escapeHTMLInData:true,formatterScope:null,editable:false,sortInfo:0,themeable:true,_placeholders:null,_layoutClass:_6.grid._Layout,buildRendering:function(){this.inherited(arguments);if(!this.domNode.getAttribute("tabIndex")){this.domNode.tabIndex="0";}this.createScroller();this.createLayout();this.createViews();this.createManagers();this.createSelection();this.connect(this.selection,"onSelected","onSelected");this.connect(this.selection,"onDeselected","onDeselected");this.connect(this.selection,"onChanged","onSelectionChanged");_6.html.metrics.initOnFontResize();this.connect(_6.html.metrics,"onFontResize","textSizeChanged");_6.grid.util.funnelEvents(this.domNode,this,"doKeyEvent",_6.grid.util.keyEvents);if(this.selectionMode!="none"){_4.attr(this.domNode,"aria-multiselectable",this.selectionMode=="single"?"false":"true");}_4.addClass(this.domNode,this.classTag);if(!this.isLeftToRight()){_4.addClass(this.domNode,this.classTag+"Rtl");}},postMixInProperties:function(){this.inherited(arguments);var _7=_4.i18n.getLocalization("dijit","loading",this.lang);this.loadingMessage=_4.string.substitute(this.loadingMessage,_7);this.errorMessage=_4.string.substitute(this.errorMessage,_7);if(this.srcNodeRef&&this.srcNodeRef.style.height){this.height=this.srcNodeRef.style.height;}this._setAutoHeightAttr(this.autoHeight,true);this.lastScrollTop=this.scrollTop=0;},postCreate:function(){this._placeholders=[];this._setHeaderMenuAttr(this.headerMenu);this._setStructureAttr(this.structure);this._click=[];this.inherited(arguments);if(this.domNode&&this.autoWidth&&this.initialWidth){this.domNode.style.width=this.initialWidth;}if(this.domNode&&!this.editable){_4.attr(this.domNode,"aria-readonly","true");}},destroy:function(){this.domNode.onReveal=null;this.domNode.onSizeChange=null;delete this._click;this.edit.destroy();delete this.edit;this.views.destroyViews();if(this.scroller){this.scroller.destroy();delete this.scroller;}if(this.focus){this.focus.destroy();delete this.focus;}if(this.headerMenu&&this._placeholders.length){_4.forEach(this._placeholders,function(p){p.unReplace(true);});this.headerMenu.unBindDomNode(this.viewsHeaderNode);}this.inherited(arguments);},_setAutoHeightAttr:function(ah,_8){if(typeof ah=="string"){if(!ah||ah=="false"){ah=false;}else{if(ah=="true"){ah=true;}else{ah=window.parseInt(ah,10);}}}if(typeof ah=="number"){if(isNaN(ah)){ah=false;}if(ah<0){ah=true;}else{if(ah===0){ah=false;}}}this.autoHeight=ah;if(typeof ah=="boolean"){this._autoHeight=ah;}else{if(typeof ah=="number"){this._autoHeight=(ah>=this.get("rowCount"));}else{this._autoHeight=false;}}if(this._started&&!_8){this.render();}},_getRowCountAttr:function(){return this.updating&&this.invalidated&&this.invalidated.rowCount!=undefined?this.invalidated.rowCount:this.rowCount;},textSizeChanged:function(){this.render();},sizeChange:function(){this.update();},createManagers:function(){this.rows=new _6.grid._RowManager(this);this.focus=new _6.grid._FocusManager(this);this.edit=new _6.grid._EditManager(this);},createSelection:function(){this.selection=new _6.grid.Selection(this);},createScroller:function(){this.scroller=new _6.grid._Scroller();this.scroller.grid=this;this.scroller.renderRow=_4.hitch(this,"renderRow");this.scroller.removeRow=_4.hitch(this,"rowRemoved");},createLayout:function(){this.layout=new this._layoutClass(this);this.connect(this.layout,"moveColumn","onMoveColumn");},onMoveColumn:function(){this.render();},onResizeColumn:function(_9){},createViews:function(){this.views=new _6.grid._ViewManager(this);this.views.createView=_4.hitch(this,"createView");},createView:function(_a,_b){var c=_4.getObject(_a);var _c=new c({grid:this,index:_b});this.viewsNode.appendChild(_c.domNode);this.viewsHeaderNode.appendChild(_c.headerNode);this.views.addView(_c);_4.attr(this.domNode,"align",_4._isBodyLtr()?"left":"right");return _c;},buildViews:function(){for(var i=0,vs;(vs=this.layout.structure[i]);i++){this.createView(vs.type||_6._scopeName+".grid._View",i).setStructure(vs);}this.scroller.setContentNodes(this.views.getContentNodes());},_setStructureAttr:function(_d){var s=_d;if(s&&_4.isString(s)){_4.deprecated("dojox.grid._Grid.set('structure', 'objVar')","use dojox.grid._Grid.set('structure', objVar) instead","2.0");s=_4.getObject(s);}this.structure=s;if(!s){if(this.layout.structure){s=this.layout.structure;}else{return;}}this.views.destroyViews();this.focus.focusView=null;if(s!==this.layout.structure){this.layout.setStructure(s);}this._structureChanged();},setStructure:function(_e){_4.deprecated("dojox.grid._Grid.setStructure(obj)","use dojox.grid._Grid.set('structure', obj) instead.","2.0");this._setStructureAttr(_e);},getColumnTogglingItems:function(){return _4.map(this.layout.cells,function(_f){if(!_f.menuItems){_f.menuItems=[];}var _10=this;var _11=new _5.CheckedMenuItem({label:_f.name,checked:!_f.hidden,_gridCell:_f,onChange:function(_12){if(_10.layout.setColumnVisibility(this._gridCell.index,_12)){var _13=this._gridCell.menuItems;if(_13.length>1){_4.forEach(_13,function(_14){if(_14!==this){_14.setAttribute("checked",_12);}},this);}_12=_4.filter(_10.layout.cells,function(c){if(c.menuItems.length>1){_4.forEach(c.menuItems,"item.set('disabled', false);");}else{c.menuItems[0].set("disabled",false);}return !c.hidden;});if(_12.length==1){_4.forEach(_12[0].menuItems,"item.set('disabled', true);");}}},destroy:function(){var _15=_4.indexOf(this._gridCell.menuItems,this);this._gridCell.menuItems.splice(_15,1);delete this._gridCell;_5.CheckedMenuItem.prototype.destroy.apply(this,arguments);}});_f.menuItems.push(_11);return _11;},this);},_setHeaderMenuAttr:function(_16){if(this._placeholders&&this._placeholders.length){_4.forEach(this._placeholders,function(p){p.unReplace(true);});this._placeholders=[];}if(this.headerMenu){this.headerMenu.unBindDomNode(this.viewsHeaderNode);}this.headerMenu=_16;if(!_16){return;}this.headerMenu.bindDomNode(this.viewsHeaderNode);if(this.headerMenu.getPlaceholders){this._placeholders=this.headerMenu.getPlaceholders(this.placeholderLabel);}},setHeaderMenu:function(_17){_4.deprecated("dojox.grid._Grid.setHeaderMenu(obj)","use dojox.grid._Grid.set('headerMenu', obj) instead.","2.0");this._setHeaderMenuAttr(_17);},setupHeaderMenu:function(){if(this._placeholders&&this._placeholders.length){_4.forEach(this._placeholders,function(p){if(p._replaced){p.unReplace(true);}p.replace(this.getColumnTogglingItems());},this);}},_fetch:function(_18){this.setScrollTop(0);},getItem:function(_19){return null;},showMessage:function(_1a){if(_1a){this.messagesNode.innerHTML=_1a;this.messagesNode.style.display="";}else{this.messagesNode.innerHTML="";this.messagesNode.style.display="none";}},_structureChanged:function(){this.buildViews();if(this.autoRender&&this._started){this.render();}},hasLayout:function(){return this.layout.cells.length;},resize:function(_1b,_1c){this._pendingChangeSize=_1b;this._pendingResultSize=_1c;this.sizeChange();},_getPadBorder:function(){this._padBorder=this._padBorder||_4._getPadBorderExtents(this.domNode);return this._padBorder;},_getHeaderHeight:function(){var vns=this.viewsHeaderNode.style,t=vns.display=="none"?0:this.views.measureHeader();vns.height=t+"px";this.views.normalizeHeaderNodeHeight();return t;},_resize:function(_1d,_1e){_1d=_1d||this._pendingChangeSize;_1e=_1e||this._pendingResultSize;delete this._pendingChangeSize;delete this._pendingResultSize;if(!this.domNode){return;}var pn=this.domNode.parentNode;if(!pn||pn.nodeType!=1||!this.hasLayout()||pn.style.visibility=="hidden"||pn.style.display=="none"){return;}var _1f=this._getPadBorder();var hh=undefined;var h;if(this._autoHeight){this.domNode.style.height="auto";}else{if(typeof this.autoHeight=="number"){h=hh=this._getHeaderHeight();h+=(this.scroller.averageRowHeight*this.autoHeight);this.domNode.style.height=h+"px";}else{if(this.domNode.clientHeight<=_1f.h){if(pn==document.body){this.domNode.style.height=this.defaultHeight;}else{if(this.height){this.domNode.style.height=this.height;}else{this.fitTo="parent";}}}}}if(_1e){_1d=_1e;}if(_1d){_4.marginBox(this.domNode,_1d);this.height=this.domNode.style.height;delete this.fitTo;}else{if(this.fitTo=="parent"){h=this._parentContentBoxHeight=this._parentContentBoxHeight||_4._getContentBox(pn).h;this.domNode.style.height=Math.max(0,h)+"px";}}var _20=_4.some(this.views.views,function(v){return v.flexCells;});if(!this._autoHeight&&(h||_4._getContentBox(this.domNode).h)===0){this.viewsHeaderNode.style.display="none";}else{this.viewsHeaderNode.style.display="block";if(!_20&&hh===undefined){hh=this._getHeaderHeight();}}if(_20){hh=undefined;}this.adaptWidth();this.adaptHeight(hh);this.postresize();},adaptWidth:function(){var _21=(!this.initialWidth&&this.autoWidth);var w=_21?0:this.domNode.clientWidth||(this.domNode.offsetWidth-this._getPadBorder().w),vw=this.views.arrange(1,w);this.views.onEach("adaptWidth");if(_21){this.domNode.style.width=vw+"px";}},adaptHeight:function(_22){var t=_22===undefined?this._getHeaderHeight():_22;var h=(this._autoHeight?-1:Math.max(this.domNode.clientHeight-t,0)||0);this.views.onEach("setSize",[0,h]);this.views.onEach("adaptHeight");if(!this._autoHeight){var _23=0,_24=0;var _25=_4.filter(this.views.views,function(v){var has=v.hasHScrollbar();if(has){_23++;}else{_24++;}return (!has);});if(_23>0&&_24>0){_4.forEach(_25,function(v){v.adaptHeight(true);});}}if(this.autoHeight===true||h!=-1||(typeof this.autoHeight=="number"&&this.autoHeight>=this.get("rowCount"))){this.scroller.windowHeight=h;}else{this.scroller.windowHeight=Math.max(this.domNode.clientHeight-t,0);}},startup:function(){if(this._started){return;}this.inherited(arguments);if(this.autoRender){this.render();}},render:function(){if(!this.domNode){return;}if(!this._started){return;}if(!this.hasLayout()){this.scroller.init(0,this.keepRows,this.rowsPerPage);return;}this.update=this.defaultUpdate;this._render();},_render:function(){this.scroller.init(this.get("rowCount"),this.keepRows,this.rowsPerPage);this.prerender();this.setScrollTop(0);this.postrender();},prerender:function(){this.keepRows=this._autoHeight?0:this.keepRows;this.scroller.setKeepInfo(this.keepRows);this.views.render();this._resize();},postrender:function(){this.postresize();this.focus.initFocusView();_4.setSelectable(this.domNode,this.selectable);},postresize:function(){if(this._autoHeight){var _26=Math.max(this.views.measureContent())+"px";this.viewsNode.style.height=_26;}},renderRow:function(_27,_28){this.views.renderRow(_27,_28,this._skipRowRenormalize);},rowRemoved:function(_29){this.views.rowRemoved(_29);},invalidated:null,updating:false,beginUpdate:function(){this.invalidated=[];this.updating=true;},endUpdate:function(){this.updating=false;var i=this.invalidated,r;if(i.all){this.update();}else{if(i.rowCount!=undefined){this.updateRowCount(i.rowCount);}else{for(r in i){this.updateRow(Number(r));}}}this.invalidated=[];},defaultUpdate:function(){if(!this.domNode){return;}if(this.updating){this.invalidated.all=true;return;}this.lastScrollTop=this.scrollTop;this.prerender();this.scroller.invalidateNodes();this.setScrollTop(this.lastScrollTop);this.postrender();},update:function(){this.render();},updateRow:function(_2a){_2a=Number(_2a);if(this.updating){this.invalidated[_2a]=true;}else{this.views.updateRow(_2a);this.scroller.rowHeightChanged(_2a);}},updateRows:function(_2b,_2c){_2b=Number(_2b);_2c=Number(_2c);var i;if(this.updating){for(i=0;i<_2c;i++){this.invalidated[i+_2b]=true;}}else{for(i=0;i<_2c;i++){this.views.updateRow(i+_2b,this._skipRowRenormalize);}this.scroller.rowHeightChanged(_2b);}},updateRowCount:function(_2d){if(this.updating){this.invalidated.rowCount=_2d;}else{this.rowCount=_2d;this._setAutoHeightAttr(this.autoHeight,true);if(this.layout.cells.length){this.scroller.updateRowCount(_2d);}this._resize();if(this.layout.cells.length){this.setScrollTop(this.scrollTop);}}},updateRowStyles:function(_2e){this.views.updateRowStyles(_2e);},getRowNode:function(_2f){if(this.focus.focusView&&!(this.focus.focusView instanceof _6.grid._RowSelector)){return this.focus.focusView.rowNodes[_2f];}else{for(var i=0,_30;(_30=this.views.views[i]);i++){if(!(_30 instanceof _6.grid._RowSelector)){return _30.rowNodes[_2f];}}}return null;},rowHeightChanged:function(_31){this.views.renormalizeRow(_31);this.scroller.rowHeightChanged(_31);},fastScroll:true,delayScroll:false,scrollRedrawThreshold:(_4.isIE?100:50),scrollTo:function(_32){if(!this.fastScroll){this.setScrollTop(_32);return;}var _33=Math.abs(this.lastScrollTop-_32);this.lastScrollTop=_32;if(_33>this.scrollRedrawThreshold||this.delayScroll){this.delayScroll=true;this.scrollTop=_32;this.views.setScrollTop(_32);if(this._pendingScroll){window.clearTimeout(this._pendingScroll);}var _34=this;this._pendingScroll=window.setTimeout(function(){delete _34._pendingScroll;_34.finishScrollJob();},200);}else{this.setScrollTop(_32);}},finishScrollJob:function(){this.delayScroll=false;this.setScrollTop(this.scrollTop);},setScrollTop:function(_35){this.scroller.scroll(this.views.setScrollTop(_35));},scrollToRow:function(_36){this.setScrollTop(this.scroller.findScrollTop(_36)+1);},styleRowNode:function(_37,_38){if(_38){this.rows.styleRowNode(_37,_38);}},_mouseOut:function(e){this.rows.setOverRow(-2);},getCell:function(_39){return this.layout.cells[_39];},setCellWidth:function(_3a,_3b){this.getCell(_3a).unitWidth=_3b;},getCellName:function(_3c){return "Cell "+_3c.index;},canSort:function(_3d){},sort:function(){},getSortAsc:function(_3e){_3e=_3e==undefined?this.sortInfo:_3e;return Boolean(_3e>0);},getSortIndex:function(_3f){_3f=_3f==undefined?this.sortInfo:_3f;return Math.abs(_3f)-1;},setSortIndex:function(_40,_41){var si=_40+1;if(_41!=undefined){si*=(_41?1:-1);}else{if(this.getSortIndex()==_40){si=-this.sortInfo;}}this.setSortInfo(si);},setSortInfo:function(_42){if(this.canSort(_42)){this.sortInfo=_42;this.sort();this.update();}},doKeyEvent:function(e){e.dispatch="do"+e.type;this.onKeyEvent(e);},_dispatch:function(m,e){if(m in this){return this[m](e);}return false;},dispatchKeyEvent:function(e){this._dispatch(e.dispatch,e);},dispatchContentEvent:function(e){this.edit.dispatchEvent(e)||e.sourceView.dispatchContentEvent(e)||this._dispatch(e.dispatch,e);},dispatchHeaderEvent:function(e){e.sourceView.dispatchHeaderEvent(e)||this._dispatch("doheader"+e.type,e);},dokeydown:function(e){this.onKeyDown(e);},doclick:function(e){if(e.cellNode){this.onCellClick(e);}else{this.onRowClick(e);}},dodblclick:function(e){if(e.cellNode){this.onCellDblClick(e);}else{this.onRowDblClick(e);}},docontextmenu:function(e){if(e.cellNode){this.onCellContextMenu(e);}else{this.onRowContextMenu(e);}},doheaderclick:function(e){if(e.cellNode){this.onHeaderCellClick(e);}else{this.onHeaderClick(e);}},doheaderdblclick:function(e){if(e.cellNode){this.onHeaderCellDblClick(e);}else{this.onHeaderDblClick(e);}},doheadercontextmenu:function(e){if(e.cellNode){this.onHeaderCellContextMenu(e);}else{this.onHeaderContextMenu(e);}},doStartEdit:function(_43,_44){this.onStartEdit(_43,_44);},doApplyCellEdit:function(_45,_46,_47){this.onApplyCellEdit(_45,_46,_47);},doCancelEdit:function(_48){this.onCancelEdit(_48);},doApplyEdit:function(_49){this.onApplyEdit(_49);},addRow:function(){this.updateRowCount(this.get("rowCount")+1);},removeSelectedRows:function(){if(this.allItemsSelected){this.updateRowCount(0);}else{this.updateRowCount(Math.max(0,this.get("rowCount")-this.selection.getSelected().length));}this.selection.clear();}});_6.grid._Grid.markupFactory=function(_4a,_4b,_4c,_4d){var d=_4;var _4e=function(n){var w=d.attr(n,"width")||"auto";if((w!="auto")&&(w.slice(-2)!="em")&&(w.slice(-1)!="%")){w=parseInt(w,10)+"px";}return w;};if(!_4a.structure&&_4b.nodeName.toLowerCase()=="table"){_4a.structure=d.query("> colgroup",_4b).map(function(cg){var sv=d.attr(cg,"span");var v={noscroll:(d.attr(cg,"noscroll")=="true")?true:false,__span:(!!sv?parseInt(sv,10):1),cells:[]};if(d.hasAttr(cg,"width")){v.width=_4e(cg);}return v;});if(!_4a.structure.length){_4a.structure.push({__span:Infinity,cells:[]});}d.query("thead > tr",_4b).forEach(function(tr,_4f){var _50=0;var _51=0;var _52;var _53=null;d.query("> th",tr).map(function(th){if(!_53){_52=0;_53=_4a.structure[0];}else{if(_50>=(_52+_53.__span)){_51++;_52+=_53.__span;var _54=_53;_53=_4a.structure[_51];}}var _55={name:d.trim(d.attr(th,"name")||th.innerHTML),colSpan:parseInt(d.attr(th,"colspan")||1,10),type:d.trim(d.attr(th,"cellType")||""),id:d.trim(d.attr(th,"id")||"")};_50+=_55.colSpan;var _56=d.attr(th,"rowspan");if(_56){_55.rowSpan=_56;}if(d.hasAttr(th,"width")){_55.width=_4e(th);}if(d.hasAttr(th,"relWidth")){_55.relWidth=window.parseInt(_4.attr(th,"relWidth"),10);}if(d.hasAttr(th,"hidden")){_55.hidden=(d.attr(th,"hidden")=="true"||d.attr(th,"hidden")===true);}if(_4d){_4d(th,_55);}_55.type=_55.type?_4.getObject(_55.type):_6.grid.cells.Cell;if(_55.type&&_55.type.markupFactory){_55.type.markupFactory(th,_55);}if(!_53.cells[_4f]){_53.cells[_4f]=[];}_53.cells[_4f].push(_55);});});}return new _4c(_4a,_4b);};})();}}};});