/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


realityBuilderDojo._xdResourceLoaded(function(_1,_2,_3){return {depends:[["provide","realityBuilder.BlockProperties"]],defineResource:function(_4,_5,_6){if(!_4._hasResource["realityBuilder.BlockProperties"]){_4._hasResource["realityBuilder.BlockProperties"]=true;_4.provide("realityBuilder.BlockProperties");_4.declare("realityBuilder.BlockProperties",null,{_versionOnServer:"-1",_has2FoldSymmetry:null,_outlineBXY:null,_rotatedOutlinesBXY:null,_collisionOffsetsListBXY:null,_rotatedCollisionOffsetsListsBXY:null,_attachmentOffsetsListB:null,_rotatedAttachmentOffsetsListsB:null,_rotCenterBXY:null,_centroidBXY:null,_backgroundAlpha:null,_congruencyOffsetsB:null,versionOnServer:function(){return this._versionOnServer;},isInitializedWithServerData:function(){return this._versionOnServer!=="-1";},_updateCentroidBXY:function(){var i,_7,_8=0,_9=0,_a=this._outlineBXY.length;for(i=0;i<_a;i+=1){_7=this._outlineBXY[i];_8+=_7[0];_9+=_7[1];}this._centroidBXY=[_8/_a,_9/_a];},_rotateOutlineBXY:function(a){var _b=this;return _4.map(this._outlineBXY,function(_c){return realityBuilder.util.rotatePointBXY(_c,_b._rotCenterBXY,a);});},_updateRotatedOutlinesBXY:function(){var a;this._rotatedOutlinesBXY=[];for(a=0;a<4;a+=1){this._rotatedOutlinesBXY.push(this._rotateOutlineBXY(a));}},_updateCongruencyOffsetB:function(){var _d,_e,a;_d=realityBuilder.util.multiplyVectorBXY(2,realityBuilder.util.subtractVectorsBXY(this._centroidBXY,this._rotCenterBXY));this._congruencyOffsetsB=[];for(a=0;a<4;a+=1){_e=realityBuilder.util.rotatePointBXY(_d,[0,0],a);this._congruencyOffsetsB.push([_e[0],_e[1],0]);}},congruencyOffsetB:function(a){return this._congruencyOffsetsB[a];},_withCongruencyOffsetsAddedBXY:function(_f,a){var _10=this.congruencyOffsetB(a);return _4.map(_f,function(_11){return realityBuilder.util.addVectorsBXY(_11,_10);});},has2FoldSymmetry:function(){return this._has2FoldSymmetry;},_completeCollisionOffsetsListBXY:function(){var _12=this._collisionOffsetsListBXY;if(this._has2FoldSymmetry){_12.push(this._withCongruencyOffsetsAddedBXY(_12[0],0));_12.push(this._withCongruencyOffsetsAddedBXY(_12[1],1));}},_rotateCollisionOffsetsBXY:function(_13,a){var _14=realityBuilder.util;return _4.map(_13,function(_15){return _14.rotatePointBXY(_15,[0,0],a);});},_rotateCollisionOffsetsListBXY:function(a1){var a2,_16,tmp=[];for(a2=0;a2<4;a2+=1){_16=this._collisionOffsetsListBXY[a2];tmp.push(this._rotateCollisionOffsetsBXY(_16,a1));}return tmp;},_updateRotatedCollisionOffsetsListsBXY:function(){var a1,tmp;this._rotatedCollisionOffsetsListsBXY=[];for(a1=0;a1<4;a1+=1){tmp=this._rotateCollisionOffsetsListBXY(a1);this._rotatedCollisionOffsetsListsBXY.push(tmp);}},_withCongruencyOffsetsAddedB:function(_17,a){var _18=this.congruencyOffsetB(a);return _4.map(_17,function(_19){return realityBuilder.util.addVectorsB(_19,_18);});},_completeAttachmentOffsetsListB:function(){var _1a=this._attachmentOffsetsListB;if(this._has2FoldSymmetry){_1a.push(this._withCongruencyOffsetsAddedB(_1a[0],0));_1a.push(this._withCongruencyOffsetsAddedB(_1a[1],1));}},_rotateAttachmentOffsetB:function(_1b,a){var _1c,_1d,_1e,_1f;_1f=realityBuilder.util;_1c=[_1b[0],_1b[1]];_1d=_1f.rotatePointBXY(_1c,[0,0],a);return [_1d[0],_1d[1],_1b[2]];},_rotateAttachmentOffsetsB:function(_20,a){var _21=this;return _4.map(_20,function(_22){return _21._rotateAttachmentOffsetB(_22,a);});},_rotateAttachmentOffsetsListB:function(a1){var a2,_23,tmp=[];for(a2=0;a2<4;a2+=1){_23=this._attachmentOffsetsListB[a2];tmp.push(this._rotateAttachmentOffsetsB(_23,a1));}return tmp;},_updateRotatedAttachmentOffsetsListsB:function(){var a1,tmp;this._rotatedAttachmentOffsetsListsB=[];for(a1=0;a1<4;a1+=1){tmp=this._rotateAttachmentOffsetsListB(a1);this._rotatedAttachmentOffsetsListsB.push(tmp);}},updateWithServerData:function(_24){if(this._versionOnServer!==_24.version){this._versionOnServer=_24.version;this._has2FoldSymmetry=_24.has2FoldSymmetry;this._posSpacingXY=_24.posSpacingXY;this._posSpacingZ=_24.posSpacingZ;this._outlineBXY=_24.outlineBXY;this._collisionOffsetsListBXY=_24.collisionOffsetsListBXY;this._attachmentOffsetsListB=_24.attachmentOffsetsListB;this._rotCenterBXY=_24.rotCenterBXY;this._backgroundAlpha=_24.backgroundAlpha;this._updateCentroidBXY();this._updateCongruencyOffsetB();this._updateRotatedOutlinesBXY();this._completeCollisionOffsetsListBXY();this._updateRotatedCollisionOffsetsListsBXY();this._completeAttachmentOffsetsListB();this._updateRotatedAttachmentOffsetsListsB();_4.publish("realityBuilder/BlockProperties/changed");}},posSpacingXY:function(){return this._posSpacingXY;},posSpacingZ:function(){return this._posSpacingZ;},rotatedOutlineBXY:function(a){return this._rotatedOutlinesBXY[a%4];},rotatedCollisionOffsetsBXY:function(_25,_26){var _27,_28,a1,a2;a1=_25.a()%4;a2=_26.a()%4;_27=this._rotatedCollisionOffsetsListsBXY[a1];_28=(4+a2-a1)%4;return _27[_28];},rotatedAttachmentOffsetsB:function(_29,_2a){var _2b,_2c,a1,a2;a1=_29.a()%4;a2=_2a.a()%4;_2b=this._rotatedAttachmentOffsetsListsB[a1];_2c=(4+a2-a1)%4;return _2b[_2c];},backgroundAlpha:function(){return this._backgroundAlpha;},rotCenterBXY:function(){return this._rotCenterBXY;}});}}};});