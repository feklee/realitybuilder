/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["com.realitybuilder.BlockProperties"]){dojo._hasResource["com.realitybuilder.BlockProperties"]=true;dojo.provide("com.realitybuilder.BlockProperties");dojo.require("com.realitybuilder.Block");dojo.declare("com.realitybuilder.BlockProperties",com.realitybuilder.Block,{_versionOnServer:"-1",_blockPositionSpacingXY:null,_blockPositionSpacingZ:null,_outlineBXY:null,_rotatedOutlinesBXY:[null,null,null,null],_collisionOffsetsListBXY:null,_rotatedCollisionOffsetsListsBXY:[null,null,null,null],_attachmentOffsetsListB:null,_rotatedAttachmentOffsetsListsB:[null,null,null,null],_rotCenterBXY:null,versionOnServer:function(){return this._versionOnServer;},isInitializedWithServerData:function(){return this._versionOnServer!=="-1";},_rotateOutlineBXY:function(a){var _1=this;return dojo.map(this._outlineBXY,function(_2){return com.realitybuilder.util.rotatePointBXY(_2,_1._rotCenterBXY,a);});},_updateRotatedOutlinesBXY:function(){var a;for(a=0;a<4;a+=1){this._rotatedOutlinesBXY[a]=this._rotateOutlineBXY(a);}},_rotateCollisionOffsetsBXY:function(_3,a){var _4=com.realitybuilder.util;return dojo.map(_3,function(_5){return _4.rotatePointBXY(_5,[0,0],a);});},_rotateCollisionOffsetsListBXY:function(a1){var a2,_6,_7=[null,null,null,null];for(a2=0;a2<4;a2+=1){_6=this._collisionOffsetsListBXY[a2];_7[a2]=this._rotateCollisionOffsetsBXY(_6,a1);}return _7;},_updateRotatedCollisionOffsetsListsBXY:function(){var a1;for(a1=0;a1<4;a1+=1){this._rotatedCollisionOffsetsListsBXY[a1]=this._rotateCollisionOffsetsListBXY(a1);}},_rotateAttachmentOffsetB:function(_8,a){var _9,_a,_b,_c;_c=com.realitybuilder.util;_9=[_8[0],_8[1]];_a=_c.rotatePointBXY(_9,[0,0],a);return [_a[0],_a[1],_8[2]];},_rotateAttachmentOffsetsB:function(_d,a){var _e=this;return dojo.map(_d,function(_f){return _e._rotateAttachmentOffsetB(_f,a);});},_rotateAttachmentOffsetsListB:function(a1){var a2,_10,tmp=[null,null,null,null];for(a2=0;a2<4;a2+=1){_10=this._attachmentOffsetsListB[a2];tmp[a2]=this._rotateAttachmentOffsetsB(_10,a1);}return tmp;},_updateRotatedAttachmentOffsetsListsB:function(){var a1;for(a1=0;a1<4;a1+=1){this._rotatedAttachmentOffsetsListsB[a1]=this._rotateAttachmentOffsetsListB(a1);}},updateWithServerData:function(_11){this._versionOnServer=_11.version;this._positionSpacingXY=_11.positionSpacingXY;this._positionSpacingZ=_11.positionSpacingZ;this._outlineBXY=_11.outlineBXY;this._collisionOffsetsListBXY=_11.collisionOffsetsListBXY;this._attachmentOffsetsListB=_11.attachmentOffsetsListB;this._rotCenterBXY=_11.rotCenterBXY;this._updateRotatedOutlinesBXY();this._updateRotatedCollisionOffsetsListsBXY();this._updateRotatedAttachmentOffsetsListsB();dojo.publish("com/realitybuilder/BlockProperties/changed");},positionSpacingXY:function(){return this._positionSpacingXY;},positionSpacingZ:function(){return this._positionSpacingZ;},rotatedOutlineBXY:function(a){return this._rotatedOutlinesBXY[a%4];},rotatedCollisionOffsetsBXY:function(_12,_13){var _14,_15;_14=this._rotatedCollisionOffsetsListsBXY[_12.a()%4];_15=(4+_13.a()-_12.a())%4;return _14[_15];},rotatedAttachmentOffsetsB:function(_16,_17){var _18,_19;_18=this._rotatedAttachmentOffsetsListsB[_16.a()%4];_19=(4+_17.a()-_16.a())%4;return _18[_19];}});}