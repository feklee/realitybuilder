/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["com.realitybuilder.CoordinateControls"]){dojo._hasResource["com.realitybuilder.CoordinateControls"]=true;dojo.provide("com.realitybuilder.CoordinateControls");dojo.require("com.realitybuilder.CoordinateButton");dojo.declare("com.realitybuilder.CoordinateControls",null,{_coordinateButtons:null,_newBlock:null,_canvas:null,_camera:null,constructor:function(_1,_2){this._newBlock=_1;this._camera=_2;this._coordinateButtons=[];this._canvas=dojo.byId("coordinateControlsCanvas");this._setCanvasDimensions();},_setCanvasDimensions:function(){var _3=this._camera.sensor(),_4=_3.width(),_5=_3.height();dojo.attr(this._canvas,"width",_4);dojo.attr(this._canvas,"height",_5);dojo.style(this._canvas,"width",_4+"px");dojo.style(this._canvas,"height",_5+"px");},update:function(_6){var _7=this._coordinateButtons;dojo.forEach(_7,function(cb){cb.update(_6);});},render:function(){if(this._canvas.getContext){var _8=this._canvas.getContext("2d");_8.clearRect(0,0,this._canvas.width,this._canvas.height);}this._renderButtonPair(0,[3,-1.5,0],[7,-1.5,0]);this._renderButtonPair(1,[11.5,3,0],[11.5,7,0]);this._renderButtonPair(2,[0,-1.5,1],[0,-1.5,4]);},_renderLine:function(_9,_a){var _b,_c,_d,_e,_f,_10,_11,_12,_13,_14,_15,_16;_b=_9.centerS;_c=_a.centerS;_d=_9.radiusS();_e=[_c[0]-_b[0],_c[1]-_b[1]];_f=com.realitybuilder.util.cartesianToPolar(_e);_10=_f[0];_11=_f[1];_12=com.realitybuilder.util.polarToCartesian([_10,_d+0.5]);_13=com.realitybuilder.util.polarToCartesian([_10,_11-_d-0.5]);_14=com.realitybuilder.util.addS(_b,_12);_15=com.realitybuilder.util.addS(_b,_13);if(this._canvas.getContext){_16=this._canvas.getContext("2d");_16.strokeStyle="white";_16.beginPath();_16.moveTo(_14[0],_14[1]);_16.lineTo(_15[0],_15[1]);_16.stroke();}},_renderButton:function(_17,_18,_19){var _1a=this._camera.blockToSensor(_19),i=2*_17+(_18?1:0),_1b;if(this._coordinateButtons[i]){_1b=this._coordinateButtons[i];_1b.move(_1a);}else{_1b=new com.realitybuilder.CoordinateButton(this._newBlock,_1a,_17,_18);this._coordinateButtons[i]=_1b;}return _1b;},_renderButtonPair:function(_1c,_1d,_1e){var _1f=this._renderButton(_1c,false,_1d),_20=this._renderButton(_1c,true,_1e);this._renderLine(_1f,_20);}});}