/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


realitybuilderDojo._xdResourceLoaded(function(_1,_2,_3){return {depends:[["provide","dojox.mobile.scrollable"]],defineResource:function(_4,_5,_6){if(!_4._hasResource["dojox.mobile.scrollable"]){_4._hasResource["dojox.mobile.scrollable"]=true;if(typeof _4!="undefined"&&_4.provide){_4.provide("dojox.mobile.scrollable");}else{_4={doc:document,global:window,isWebKit:navigator.userAgent.indexOf("WebKit")!=-1};_6={mobile:{}};}_6.mobile.scrollable=function(){this.fixedHeaderHeight=0;this.fixedFooterHeight=0;this.isLocalFooter=false;this.scrollBar=true;this.scrollDir="v";this.weight=0.6;this.fadeScrollBar=true;this.disableFlashScrollBar=false;this.threshold=0;this.init=function(_7){if(_7){for(var p in _7){if(_7.hasOwnProperty(p)){this[p]=((p=="domNode"||p=="containerNode")&&typeof _7[p]=="string")?_4.doc.getElementById(_7[p]):_7[p];}}}this._v=(this.scrollDir.indexOf("v")!=-1);this._h=(this.scrollDir.indexOf("h")!=-1);this._f=(this.scrollDir=="f");this._ch=[];this._ch.push(_4.connect(this.containerNode,_6.mobile.hasTouch?"touchstart":"onmousedown",this,"onTouchStart"));if(_4.isWebKit){this._ch.push(_4.connect(this.domNode,"webkitAnimationEnd",this,"onFlickAnimationEnd"));this._ch.push(_4.connect(this.domNode,"webkitAnimationStart",this,"onFlickAnimationStart"));}if(_4.global.onorientationchange!==undefined){this._ch.push(_4.connect(_4.global,"onorientationchange",this,"resizeView"));}else{this._ch.push(_4.connect(_4.global,"onresize",this,"resizeView"));}this.resizeView();var _8=this;setTimeout(function(){_8.flashScrollBar();},600);};this.cleanup=function(){for(var i=0;i<this._ch.length;i++){_4.disconnect(this._ch[i]);}this._ch=null;};this.resizeView=function(e){this._appFooterHeight=(this.fixedFooterHeight&&!this.isLocalFooter)?this.fixedFooterHeight:0;this.containerNode.style.paddingTop=this.fixedHeaderHeight+"px";var c=0;var _9=this;var id=setInterval(function(){_9.domNode.style.height=(_4.global.innerHeight||_4.doc.documentElement.clientHeight)-_9._appFooterHeight+"px";_9.resetScrollBar();if(c++>=4){clearInterval(id);}},300);};this.onFlickAnimationStart=function(e){_4.stopEvent(e);};this.onFlickAnimationEnd=function(e){if(e&&e.srcElement){_4.stopEvent(e);}this.stopAnimation();if(this._bounce){var _a=this;var _b=_a._bounce;setTimeout(function(){_a.slideTo(_b,0.3,"ease-out");},0);_a._bounce=undefined;}else{this.hideScrollBar();this.removeCover();}};this.onTouchStart=function(e){if(this._conn&&(new Date()).getTime()-this.startTime<500){return;}if(!this._conn){this._conn=[];this._conn.push(_4.connect(_4.doc,_6.mobile.hasTouch?"touchmove":"onmousemove",this,"onTouchMove"));this._conn.push(_4.connect(_4.doc,_6.mobile.hasTouch?"touchend":"onmouseup",this,"onTouchEnd"));}this._aborted=false;if(_4.hasClass(this.containerNode,"mblScrollableScrollTo2")){this.abort();}this.touchStartX=e.touches?e.touches[0].pageX:e.clientX;this.touchStartY=e.touches?e.touches[0].pageY:e.clientY;this.startTime=(new Date()).getTime();this.startPos=this.getPos();this._dim=this.getDim();this._time=[0];this._posX=[this.touchStartX];this._posY=[this.touchStartY];if(e.target.nodeType!=1||(e.target.tagName!="SELECT"&&e.target.tagName!="INPUT"&&e.target.tagName!="TEXTAREA")){_4.stopEvent(e);}};this.onTouchMove=function(e){var x=e.touches?e.touches[0].pageX:e.clientX;var y=e.touches?e.touches[0].pageY:e.clientY;var dx=x-this.touchStartX;var dy=y-this.touchStartY;var to={x:this.startPos.x+dx,y:this.startPos.y+dy};var _c=this._dim;if(this._time.length==1){if(dx<this.threshold&&dy<this.threshold){return;}this.addCover();this.showScrollBar();}var _d=this.weight;if(this._v){if(to.y>0){to.y=Math.round(to.y*_d);}else{if(to.y<-_c.o.h){if(_c.c.h<_c.d.h){to.y=Math.round(to.y*_d);}else{to.y=-_c.o.h-Math.round((-_c.o.h-to.y)*_d);}}}}if(this._h||this._f){if(to.x>0){to.x=Math.round(to.x*_d);}else{if(to.x<-_c.o.w){if(_c.c.w<_c.d.w){to.x=Math.round(to.x*_d);}else{to.x=-_c.o.w-Math.round((-_c.o.w-to.x)*_d);}}}}this.scrollTo(to);var _e=10;var n=this._time.length;if(n>=2){var d0,d1;if(this._v&&!this._h){d0=this._posY[n-1]-this._posY[n-2];d1=y-this._posY[n-1];}else{if(!this._v&&this._h){d0=this._posX[n-1]-this._posX[n-2];d1=x-this._posX[n-1];}}if(d0*d1<0){this._time=[this._time[n-1]];this._posX=[this._posX[n-1]];this._posY=[this._posY[n-1]];n=1;}}if(n==_e){this._time.shift();this._posX.shift();this._posY.shift();}this._time.push((new Date()).getTime()-this.startTime);this._posX.push(x);this._posY.push(y);};this.onTouchEnd=function(e){if(!this._conn){return;}for(var i=0;i<this._conn.length;i++){_4.disconnect(this._conn[i]);}this._conn=null;var n=this._time.length;var _f=false;if(!this._aborted){if(n<=1){_f=true;}else{if(n==2&&Math.abs(this._posY[1]-this._posY[0])<4){_f=true;}}}if(_f){this.hideScrollBar();this.removeCover();if(_6.mobile.hasTouch){var _10=e.target;if(_10.nodeType!=1){_10=_10.parentNode;}var ev=_4.doc.createEvent("MouseEvents");ev.initEvent("click",true,true);_10.dispatchEvent(ev);}return;}var _11={x:0,y:0};if(n>=2&&(new Date()).getTime()-this.startTime-this._time[n-1]<500){var dy=this._posY[n-(n>3?2:1)]-this._posY[(n-6)>=0?n-6:0];var dx=this._posX[n-(n>3?2:1)]-this._posX[(n-6)>=0?n-6:0];var dt=this._time[n-(n>3?2:1)]-this._time[(n-6)>=0?n-6:0];_11.y=this.calcSpeed(dy,dt);_11.x=this.calcSpeed(dx,dt);}var pos=this.getPos();var to={};var dim=this._dim;if(this._v){to.y=pos.y+_11.y;}if(this._h||this._f){to.x=pos.x+_11.x;}if(this.scrollDir=="v"&&dim.c.h<=dim.d.h){this.slideTo({y:0},0.3,"ease-out");return;}else{if(this.scrollDir=="h"&&dim.c.w<=dim.d.w){this.slideTo({x:0},0.3,"ease-out");return;}else{if(this._v&&this._h&&dim.c.h<=dim.d.h&&dim.c.w<=dim.d.w){this.slideTo({x:0,y:0},0.3,"ease-out");return;}}}var _12,_13="ease-out";var _14={};if(this._v){if(to.y>0){if(pos.y>0){_12=0.3;to.y=0;}else{to.y=Math.min(to.y,20);_13="linear";_14.y=0;}}else{if(-_11.y>dim.o.h-(-pos.y)){if(pos.y<-dim.o.h){_12=0.3;to.y=dim.c.h<=dim.d.h?0:-dim.o.h;}else{to.y=Math.max(to.y,-dim.o.h-20);_13="linear";_14.y=-dim.o.h;}}}}if(this._h||this._f){if(to.x>0){if(pos.x>0){_12=0.3;to.x=0;}else{to.x=Math.min(to.x,20);_13="linear";_14.x=0;}}else{if(-_11.x>dim.o.w-(-pos.x)){if(pos.x<-dim.o.w){_12=0.3;to.x=dim.c.w<=dim.d.w?0:-dim.o.w;}else{to.x=Math.max(to.x,-dim.o.w-20);_13="linear";_14.x=-dim.o.w;}}}}this._bounce=(_14.x!==undefined||_14.y!==undefined)?_14:undefined;if(_12===undefined){var _15,_16;if(this._v&&this._h){_16=Math.sqrt(_11.x+_11.x+_11.y*_11.y);_15=Math.sqrt(Math.pow(to.y-pos.y,2)+Math.pow(to.x-pos.x,2));}else{if(this._v){_16=_11.y;_15=to.y-pos.y;}else{if(this._h){_16=_11.x;_15=to.x-pos.x;}}}_12=_16!==0?Math.abs(_15/_16):0.01;}this.slideTo(to,_12,_13);};this.abort=function(){this.scrollTo(this.getPos());this.stopAnimation();this._aborted=true;};this.stopAnimation=function(){_4.removeClass(this.containerNode,"mblScrollableScrollTo2");if(this._scrollBarV){this._scrollBarV.className="";}if(this._scrollBarH){this._scrollBarH.className="";}};this.calcSpeed=function(d,t){return Math.round(d/t*100)*4;};this.scrollTo=function(to,_17){var s=this.containerNode.style;if(_4.isWebKit){s.webkitTransform=this.makeTranslateStr(to);}else{if(this._v){s.top=to.y+"px";}if(this._h||this._f){s.left=to.x+"px";}}if(!_17){this.scrollScrollBarTo(this.calcScrollBarPos(to));}};this.slideTo=function(to,_18,_19){this._runSlideAnimation(this.getPos(),to,_18,_19,this.containerNode,2);this.slideScrollBarTo(to,_18,_19);};this.makeTranslateStr=function(to){var y=this._v&&typeof to.y=="number"?to.y+"px":"0px";var x=(this._h||this._f)&&typeof to.x=="number"?to.x+"px":"0px";return _6.mobile.hasTranslate3d?"translate3d("+x+","+y+",0px)":"translate("+x+","+y+")";};this.getPos=function(){if(_4.isWebKit){var m=_4.doc.defaultView.getComputedStyle(this.containerNode,"")["-webkit-transform"];if(m&&m.indexOf("matrix")===0){var arr=m.split(/[,\s\)]+/);return {y:arr[5]-0,x:arr[4]-0};}return {x:0,y:0};}else{return {y:this.containerNode.offsetTop,x:this.containerNode.offsetLeft};}};this.getDim=function(){var d={};d.c={h:this.containerNode.offsetHeight-this.fixedHeaderHeight,w:this.containerNode.offsetWidth};d.v={h:this.domNode.offsetHeight+this._appFooterHeight,w:this.domNode.offsetWidth};d.d={h:d.v.h-this.fixedHeaderHeight-this.fixedFooterHeight,w:d.v.w};d.o={h:d.c.h-d.v.h+this.fixedHeaderHeight+this.fixedFooterHeight,w:d.c.w-d.v.w};return d;};this.showScrollBar=function(){if(!this.scrollBar){return;}var dim=this._dim;if(this.scrollDir=="v"&&dim.c.h<=dim.d.h){return;}if(this.scrollDir=="h"&&dim.c.w<=dim.d.w){return;}if(this._v&&this._h&&dim.c.h<=dim.d.h&&dim.c.w<=dim.d.w){return;}var _1a=function(_1b,dir){var bar=_1b["_scrollBarNode"+dir];if(!bar){var _1c=_4.create("div",null,_1b.domNode);var _1d={position:"absolute",overflow:"hidden"};if(dir=="V"){_1d.right="2px";_1d.width="5px";}else{_1d.bottom=(_1b.isLocalFooter?_1b.fixedFooterHeight:0)+2+"px";_1d.height="5px";}_4.style(_1c,_1d);_1c.className="mblScrollBarWrapper";_1b["_scrollBarWrapper"+dir]=_1c;bar=_4.create("div",null,_1c);_4.style(bar,{opacity:0.6,position:"absolute",backgroundColor:"#606060",fontSize:"1px",webkitBorderRadius:"2px",MozBorderRadius:"2px",webkitTransformOrigin:"0 0",zIndex:2147483647});_4.style(bar,dir=="V"?{width:"5px"}:{height:"5px"});_1b["_scrollBarNode"+dir]=bar;}return bar;};if(this._v&&!this._scrollBarV){this._scrollBarV=_1a(this,"V");}if(this._h&&!this._scrollBarH){this._scrollBarH=_1a(this,"H");}this.resetScrollBar();};this.hideScrollBar=function(){var _1e;if(this.fadeScrollBar&&_4.isWebKit){if(!_6.mobile._fadeRule){var _1f=_4.create("style",null,_4.doc.getElementsByTagName("head")[0]);_1f.textContent=".mblScrollableFadeOutScrollBar{"+"  -webkit-animation-duration: 1s;"+"  -webkit-animation-name: scrollableViewFadeOutScrollBar;}"+"@-webkit-keyframes scrollableViewFadeOutScrollBar{"+"  from { opacity: 0.6; }"+"  50% { opacity: 0.6; }"+"  to { opacity: 0; }}";_6.mobile._fadeRule=_1f.sheet.cssRules[1];}_1e=_6.mobile._fadeRule;}if(!this.scrollBar){return;}var f=function(bar){_4.style(bar,{opacity:0,webkitAnimationDuration:""});bar.className="mblScrollableFadeOutScrollBar";};if(this._scrollBarV){f(this._scrollBarV);this._scrollBarV=null;}if(this._scrollBarH){f(this._scrollBarH);this._scrollBarH=null;}};this.calcScrollBarPos=function(to){var pos={};var dim=this._dim;var f=function(_20,_21,t,d,c){var y=Math.round((d-_21-8)/(d-c)*t);if(y<-_21+5){y=-_21+5;}if(y>_20-5){y=_20-5;}return y;};if(typeof to.y=="number"&&this._scrollBarV){pos.y=f(this._scrollBarWrapperV.offsetHeight,this._scrollBarV.offsetHeight,to.y,dim.d.h,dim.c.h);}if(typeof to.x=="number"&&this._scrollBarH){pos.x=f(this._scrollBarWrapperH.offsetWidth,this._scrollBarH.offsetWidth,to.x,dim.d.w,dim.c.w);}return pos;};this.scrollScrollBarTo=function(to){if(!this.scrollBar){return;}if(this._v&&this._scrollBarV&&typeof to.y=="number"){if(_4.isWebKit){this._scrollBarV.style.webkitTransform=this.makeTranslateStr({y:to.y});}else{this._scrollBarV.style.top=to.y+"px";}}if(this._h&&this._scrollBarH&&typeof to.x=="number"){if(_4.isWebKit){this._scrollBarH.style.webkitTransform=this.makeTranslateStr({x:to.x});}else{this._scrollBarH.style.left=to.x+"px";}}};this.slideScrollBarTo=function(to,_22,_23){if(!this.scrollBar){return;}var _24=this.calcScrollBarPos(this.getPos());var _25=this.calcScrollBarPos(to);if(this._v&&this._scrollBarV){this._runSlideAnimation({y:_24.y},{y:_25.y},_22,_23,this._scrollBarV,0);}if(this._h&&this._scrollBarH){this._runSlideAnimation({x:_24.x},{x:_25.x},_22,_23,this._scrollBarH,1);}};this._runSlideAnimation=function(_26,to,_27,_28,_29,idx){if(_4.isWebKit){this.setKeyframes(_26,to,idx);_4.style(_29,{webkitAnimationDuration:_27+"s",webkitAnimationTimingFunction:_28});_4.addClass(_29,"mblScrollableScrollTo"+idx);if(idx==2){this.scrollTo(to,true);}else{this.scrollScrollBarTo(to);}}else{if(_4.fx&&_4.fx.easing){var s=_4.fx.slideTo({node:_29,duration:_27*1000,left:to.x,top:to.y,easing:(_28=="ease-out")?_4.fx.easing.quadOut:_4.fx.easing.linear}).play();if(idx==2){_4.connect(s,"onEnd",this,"onFlickAnimationEnd");}}else{if(idx==2){this.scrollTo(to);this.onFlickAnimationEnd();}else{this.scrollScrollBarTo(to);}}}};this.resetScrollBar=function(){var f=function(_2a,bar,d,c,hd,v){if(!bar){return;}var _2b={};_2b[v?"top":"left"]=hd+4+"px";_2b[v?"height":"width"]=d-8+"px";_4.style(_2a,_2b);var l=Math.round(d*d/c);l=Math.min(Math.max(l-8,5),d-8);bar.style[v?"height":"width"]=l+"px";_4.style(bar,{"opacity":0.6});};var dim=this.getDim();f(this._scrollBarWrapperV,this._scrollBarV,dim.d.h,dim.c.h,this.fixedHeaderHeight,true);f(this._scrollBarWrapperH,this._scrollBarH,dim.d.w,dim.c.w,0);this.createMask();};this.createMask=function(){if(!_4.isWebKit){return;}var ctx;if(this._scrollBarWrapperV){var h=this._scrollBarWrapperV.offsetHeight;ctx=_4.doc.getCSSCanvasContext("2d","scrollBarMaskV",5,h);ctx.fillStyle="rgba(0,0,0,0.5)";ctx.fillRect(1,0,3,2);ctx.fillRect(0,1,5,1);ctx.fillRect(0,h-2,5,1);ctx.fillRect(1,h-1,3,2);ctx.fillStyle="rgb(0,0,0)";ctx.fillRect(0,2,5,h-4);this._scrollBarWrapperV.style.webkitMaskImage="-webkit-canvas(scrollBarMaskV)";}if(this._scrollBarWrapperH){var w=this._scrollBarWrapperH.offsetWidth;ctx=_4.doc.getCSSCanvasContext("2d","scrollBarMaskH",w,5);ctx.fillStyle="rgba(0,0,0,0.5)";ctx.fillRect(0,1,2,3);ctx.fillRect(1,0,1,5);ctx.fillRect(w-2,0,1,5);ctx.fillRect(w-1,1,2,3);ctx.fillStyle="rgb(0,0,0)";ctx.fillRect(2,0,w-4,5);this._scrollBarWrapperH.style.webkitMaskImage="-webkit-canvas(scrollBarMaskH)";}};this.flashScrollBar=function(){if(this.disableFlashScrollBar){return;}this._dim=this.getDim();if(this._dim.d.h<=0){return;}this.showScrollBar();var _2c=this;setTimeout(function(){_2c.hideScrollBar();},300);};this.addCover=function(){if(!_6.mobile.hasTouch&&!this.noCover){if(!this._cover){this._cover=_4.create("div",null,_4.doc.body);_4.style(this._cover,{backgroundColor:"#ffff00",opacity:0,position:"absolute",top:"0px",left:"0px",width:"100%",height:"100%",zIndex:2147483647});this._ch.push(_4.connect(this._cover,_6.mobile.hasTouch?"touchstart":"onmousedown",this,"onTouchEnd"));}else{this._cover.style.display="";}}this.setSelectable(this.domNode,false);var sel;if(_4.global.getSelection){sel=_4.global.getSelection();sel.collapse(_4.doc.body,0);}else{sel=_4.doc.selection.createRange();sel.setEndPoint("EndToStart",sel);sel.select();}};this.removeCover=function(){if(!_6.mobile.hasTouch&&this._cover){this._cover.style.display="none";}this.setSelectable(this.domNode,true);};this.setKeyframes=function(_2d,to,idx){if(!_6.mobile._rule){_6.mobile._rule=[];}if(!_6.mobile._rule[idx]){var _2e=_4.create("style",null,_4.doc.getElementsByTagName("head")[0]);_2e.textContent=".mblScrollableScrollTo"+idx+"{-webkit-animation-name: scrollableViewScroll"+idx+";}"+"@-webkit-keyframes scrollableViewScroll"+idx+"{}";_6.mobile._rule[idx]=_2e.sheet.cssRules[1];}var _2f=_6.mobile._rule[idx];if(_2f){if(_2d){_2f.deleteRule("from");_2f.insertRule("from { -webkit-transform: "+this.makeTranslateStr(_2d)+"; }");}if(to){if(to.x===undefined){to.x=_2d.x;}if(to.y===undefined){to.y=_2d.y;}_2f.deleteRule("to");_2f.insertRule("to { -webkit-transform: "+this.makeTranslateStr(to)+"; }");}}};this.setSelectable=function(_30,_31){_30.style.KhtmlUserSelect=_31?"auto":"none";_30.style.MozUserSelect=_31?"":"none";_30.onselectstart=_31?null:function(){return false;};_30.unselectable=_31?"":"on";};};(function(){if(_4.isWebKit){var _32=_4.doc.createElement("div");_32.style.webkitTransform="translate3d(0px,1px,0px)";_4.doc.documentElement.appendChild(_32);var v=_4.doc.defaultView.getComputedStyle(_32,"")["-webkit-transform"];_6.mobile.hasTranslate3d=v&&v.indexOf("matrix")===0;_4.doc.documentElement.removeChild(_32);_6.mobile.hasTouch=(typeof _4.doc.documentElement.ontouchstart!="undefined"&&navigator.appVersion.indexOf("Mobile")!=-1);}})();}}};});