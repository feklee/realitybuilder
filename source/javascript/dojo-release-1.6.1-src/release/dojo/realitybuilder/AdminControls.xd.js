/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


realitybuilderDojo._xdResourceLoaded(function(_1,_2,_3){return {depends:[["provide","realitybuilder.AdminControls"],["require","dojox.date.posix"]],defineResource:function(_4,_5,_6){if(!_4._hasResource["realitybuilder.AdminControls"]){_4._hasResource["realitybuilder.AdminControls"]=true;_4.provide("realitybuilder.AdminControls");_4.require("dojox.date.posix");_4.declare("realitybuilder.AdminControls",null,{_construction:null,constructor:function(_7){this._construction=_7;_4.byId("bottomBar").style.width=_7.camera().sensor().width()+"px";this.updateToggleRealButton();this.updateTogglePendingButton();_4.connect(_4.byId("saveSettingsButton"),"onclick",this._construction,this._construction.storeSettingsOnServer);_4.connect(_4.byId("previewCameraButton"),"onclick",this,this.updateCamera);_4.connect(_4.byId("toggleRealButton"),"onclick",this._construction,this._construction.toggleReal);_4.connect(_4.byId("togglePendingButton"),"onclick",this._construction,this._construction.togglePending);_4.connect(_4.byId("logoutButton"),"onclick",this,this.logOut);_4.connect(_4.byId("setPrerenderedBlockConfigurationButton"),"onclick",this,this.setPrerenderedBlockConfiguration);_4.connect(_4.byId("prevPrerenderedBlockConfigurationButton"),"onclick",this,this.prevPrerenderedBlockConfiguration);_4.connect(_4.byId("nextPrerenderedBlockConfigurationButton"),"onclick",this,this.nextPrerenderedBlockConfiguration);},logOut:function(){location.href=logoutUrl;},updateToggleRealButton:function(){_4.byId("toggleRealButton").innerHTML=(this._construction.showReal()?"Hide":"Show")+" Real Blocks";},updateTogglePendingButton:function(){_4.byId("togglePendingButton").innerHTML=(this._construction.showPending()?"Hide":"Show")+" Pending Blocks";},updateCameraControls:function(_8){var _9=_8.position();_4.byId("cameraXTextField").value=_9[0];_4.byId("cameraYTextField").value=_9[1];_4.byId("cameraZTextField").value=_9[2];_4.byId("cameraAXTextField").value=_8.aX();_4.byId("cameraAYTextField").value=_8.aY();_4.byId("cameraAZTextField").value=_8.aZ();_4.byId("cameraFlTextField").value=_8.fl();_4.byId("cameraSensorResolutionTextField").value=_8.sensorResolution();},updateImageControls:function(_a){_4.byId("imageUrlTextField").value=_a.url();_4.byId("imageUpdateIntervalServerTextField").value=_a.updateIntervalServer();},updatePrerenderModeControls:function(){var _b=this._construction.prerenderMode();if(_b.isEnabled()){_4.byId("prerenderedBlockConfigurationTextField").value=_b.i();_4.style("prerenderedBlockConfigurations","display","block");}else{_4.style("prerenderedBlockConfigurations","display","none");}},setPrerenderedBlockConfiguration:function(){var _c,i;_c=this._construction.prerenderMode();i=parseInt(_4.byId("prerenderedBlockConfigurationTextField").value,10);_c.loadBlockConfigurationOnServer(i);},prevPrerenderedBlockConfiguration:function(){var _d=this._construction.prerenderMode();_d.loadPrevBlockConfigurationOnServer();},nextPrerenderedBlockConfiguration:function(){var _e=this._construction.prerenderMode();_e.loadNextBlockConfigurationOnServer();},readImageControls:function(){var _f={"url":_4.byId("imageUrlTextField").value||"","updateIntervalServer":parseFloat(_4.byId("imageUpdateIntervalServerTextField").value)||5};return _f;},readCameraControls:function(){var _10={"position":[parseFloat(_4.byId("cameraXTextField").value)||0,parseFloat(_4.byId("cameraYTextField").value)||0,parseFloat(_4.byId("cameraZTextField").value)||0],"aX":parseFloat(_4.byId("cameraAXTextField").value)||0,"aY":parseFloat(_4.byId("cameraAYTextField").value)||0,"aZ":parseFloat(_4.byId("cameraAZTextField").value)||0,"fl":parseFloat(_4.byId("cameraFlTextField").value)||1,"sensorResolution":parseFloat(_4.byId("cameraSensorResolutionTextField").value)||100};return _10;},updateCamera:function(){this._construction.camera().update(this.readCameraControls());},updateCoordinateDisplays:function(){var _11,a;_11=this._construction.newBlock().positionB();a=this._construction.newBlock().a();_4.byId("newBlockXB").innerHTML=_11[0].toString();_4.byId("newBlockYB").innerHTML=_11[1].toString();_4.byId("newBlockZB").innerHTML=_11[2].toString();_4.byId("newBlockA").innerHTML=a.toString();},_sortForTable:function(x,y){if(x.state()===y.state()){if(x.timeStamp()>y.timeStamp()){return -1;}else{if(x.timeStamp()<y.timeStamp()){return 1;}else{return 0;}}}else{if(x.state()===1){return -1;}else{if(x.state()===2){return y.state()===1?1:-1;}else{return 1;}}}},_blocksSortedForTable:function(){var tmp=_4.map(this._construction.constructionBlocks().blocks(),function(_12){return _12;});tmp.sort(this._sortForTable);return tmp;},_applyStateFromStateSelector:function(_13,_14){this._construction.constructionBlocks().setBlockStateOnServer(_14.positionB(),_14.a(),parseInt(_13.value,10));},_stateSelector:function(_15){var _16=document.createElement("select"),_17=["Deleted","Pending","Real"],_18,_19,_1a;_4.attr(_16,"size",1);for(_18=0;_18<3;_18+=1){_19=_17[_18];_1a=document.createElement("option");_4.attr(_1a,"value",_18);if(_18===_15.state()){_4.attr(_1a,"selected","");}_1a.innerHTML=_19;_16.appendChild(_1a);}_4.connect(_16,"onchange",this,function(_1b){this._applyStateFromStateSelector(_16,_15);});return _16;},_appendBlocksTableRow:function(_1c,_1d){var _1e,row,_1f,_20,_21,_22;_1e=_1c.positionB();row=document.createElement("tr");_1f=new Date(_1c.timeStamp()*1000);_20=_6.date.posix.strftime(_1f,"%Y-%m-%d %H:%M:%S");_21=[_1e[0],_1e[1],_1e[2],_1c.a(),_20,this._stateSelector(_1c)];_4.forEach(_21,function(_23,i){_22=document.createElement("td");if(i<5){_22.innerHTML=_23;}else{_22.appendChild(_23);}if(i<4){_4.addClass(_22,"number");}row.appendChild(_22);});_1d.appendChild(row);},updateBlocksTable:function(){var _24=_4.query("#blocksTable tbody"),_25=_24[0],_26=this._blocksSortedForTable(),_27=this;_4.empty(_25);_4.forEach(_26,function(_28){_27._appendBlocksTableRow(_28,_25);});}});}}};});