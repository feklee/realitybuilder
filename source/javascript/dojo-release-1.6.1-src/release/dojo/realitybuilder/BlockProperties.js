/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


if(!dojo._hasResource["realitybuilder.BlockProperties"]){dojo._hasResource["realitybuilder.BlockProperties"]=true;dojo.provide("realitybuilder.BlockProperties");dojo.declare("realitybuilder.BlockProperties",null,{_versionOnServer:"-1",_congruencyA:null,_blockPositionSpacingXY:null,_blockPositionSpacingZ:null,_outlineBXY:null,_rotatedOutlinesBXY:null,_collisionOffsetsListBXY:null,_rotatedCollisionOffsetsListsBXY:null,_attachmentOffsetsListB:null,_rotatedAttachmentOffsetsListsB:null,_rotCenterBXY:null,_backgroundAlpha:null,versionOnServer:function(){return this._versionOnServer;},isInitializedWithServerData:function(){return this._versionOnServer!=="-1";},congruencyA:function(){return this._congruencyA;},_rotateOutlineBXY:function(a){var _1=this;return dojo.map(this._outlineBXY,function(_2){return realitybuilder.util.rotatePointBXY(_2,_1._rotCenterBXY,a);});},_updateRotatedOutlinesBXY:function(){var a;this._rotatedOutlinesBXY=[];for(a=0;a<this._congruencyA;a+=1){this._rotatedOutlinesBXY.push(this._rotateOutlineBXY(a));}},_rotateCollisionOffsetsBXY:function(_3,a){var _4=realitybuilder.util;return dojo.map(_3,function(_5){return _4.rotatePointBXY(_5,[0,0],a);});},_rotateCollisionOffsetsListBXY:function(a1){var a2,_6,_7=[];for(a2=0;a2<this._congruencyA;a2+=1){_6=this._collisionOffsetsListBXY[a2];_7.push(this._rotateCollisionOffsetsBXY(_6,a1));}return _7;},_updateRotatedCollisionOffsetsListsBXY:function(){var a1,_8;this._rotatedCollisionOffsetsListsBXY=[];for(a1=0;a1<this._congruencyA;a1+=1){_8=this._rotateCollisionOffsetsListBXY(a1);this._rotatedCollisionOffsetsListsBXY.push(_8);}},_rotateAttachmentOffsetB:function(_9,a){var _a,_b,_c,_d;_d=realitybuilder.util;_a=[_9[0],_9[1]];_b=_d.rotatePointBXY(_a,[0,0],a);return [_b[0],_b[1],_9[2]];},_rotateAttachmentOffsetsB:function(_e,a){var _f=this;return dojo.map(_e,function(_10){return _f._rotateAttachmentOffsetB(_10,a);});},_rotateAttachmentOffsetsListB:function(a1){var a2,_11,tmp=[];for(a2=0;a2<this._congruencyA;a2+=1){_11=this._attachmentOffsetsListB[a2];tmp.push(this._rotateAttachmentOffsetsB(_11,a1));}return tmp;},_updateRotatedAttachmentOffsetsListsB:function(){var a1,tmp;this._rotatedAttachmentOffsetsListsB=[];for(a1=0;a1<this._congruencyA;a1+=1){tmp=this._rotateAttachmentOffsetsListB(a1);this._rotatedAttachmentOffsetsListsB.push(tmp);}},updateWithServerData:function(_12){if(this._versionOnServer!==_12.version){this._versionOnServer=_12.version;this._congruencyA=_12.congruencyA;this._positionSpacingXY=_12.positionSpacingXY;this._positionSpacingZ=_12.positionSpacingZ;this._outlineBXY=_12.outlineBXY;this._collisionOffsetsListBXY=_12.collisionOffsetsListBXY;this._attachmentOffsetsListB=_12.attachmentOffsetsListB;this._rotCenterBXY=_12.rotCenterBXY;this._backgroundAlpha=_12.backgroundAlpha;this._updateRotatedOutlinesBXY();this._updateRotatedCollisionOffsetsListsBXY();this._updateRotatedAttachmentOffsetsListsB();dojo.publish("realitybuilder/BlockProperties/changed");}},positionSpacingXY:function(){return this._positionSpacingXY;},positionSpacingZ:function(){return this._positionSpacingZ;},rotatedOutlineBXY:function(a){return this._rotatedOutlinesBXY[a%this._congruencyA];},rotatedCollisionOffsetsBXY:function(_13,_14){var _15,_16,a1,a2;a1=_13.a()%this._congruencyA;a2=_14.a()%this._congruencyA;_15=this._rotatedCollisionOffsetsListsBXY[a1];_16=(this._congruencyA+a2-a1)%this._congruencyA;return _15[_16];},rotatedAttachmentOffsetsB:function(_17,_18){var _19,_1a,a1,a2;a1=_17.a()%this._congruencyA;a2=_18.a()%this._congruencyA;_19=this._rotatedAttachmentOffsetsListsB[a1];_1a=(this._congruencyA+a2-a1)%this._congruencyA;return _19[_1a];},backgroundAlpha:function(){return this._backgroundAlpha;}});}