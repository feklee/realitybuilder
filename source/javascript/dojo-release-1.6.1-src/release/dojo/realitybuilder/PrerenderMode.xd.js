/*
	Copyright (c) 2004-2011, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


realitybuilderDojo._xdResourceLoaded(function(_1,_2,_3){return {depends:[["provide","realitybuilder.PrerenderMode"]],defineResource:function(_4,_5,_6){if(!_4._hasResource["realitybuilder.PrerenderMode"]){_4._hasResource["realitybuilder.PrerenderMode"]=true;_4.provide("realitybuilder.PrerenderMode");_4.declare("realitybuilder.PrerenderMode",null,{_versionOnServer:"-1",_isEnabled:null,_makeRealAfter:null,_blockConfigurations:null,_i:null,versionOnServer:function(){return this._versionOnServer;},isInitializedWithServerData:function(){return this._versionOnServer!=="-1";},updateWithServerData:function(_7){this._versionOnServer=_7.version;this._isEnabled=_7.isEnabled;this._makeRealAfter=_7.makeRealAfter;this._blockConfigurations=_7.blockConfigurations;this._i=_7.i;_4.publish("realitybuilder/PrerenderMode/changed");},i:function(){return this._i;},isEnabled:function(){return this._isEnabled;},makeRealAfter:function(){return this._makeRealAfter;},_blockConfigurationSetKey:function(_8){return _8.xB()+","+_8.yB()+","+_8.zB()+","+_8.a();},_blockConfigurationSet:function(_9,_a){var _b={},_c=this._blockConfigurationSetKey;_4.forEach(_9,function(_d){_b[_c(_d)]=true;});_b[_c(_a)]=true;return _b;},_setIsEmpty:function(_e){var _f;for(_f in _e){if(_e.hasOwnProperty(_f)){return false;}}return true;},_blockConfigurationMatches:function(_10,_11,_12){var _13,i,_14,key;_13=this._blockConfigurationSet(_11,_12);for(i=0;i<_10.length;i+=1){_14=_10[i];key=_14[0]+","+_14[1]+","+_14[2]+","+_14[3];if(typeof _13[key]==="undefined"){return false;}else{delete _13[key];}}return this._setIsEmpty(_13);},matchingBlockConfiguration:function(_15,_16){var i,_17;for(i=0;i<this._blockConfigurations.length;i+=1){_17=this._blockConfigurations[i];if(this._blockConfigurationMatches(_17,_15,_16)){return i;}}return false;},_loadBlockConfigurationOnServerSucceeded:function(){_4.publish("realitybuilder/PrerenderMode/"+"loadedBlockConfigurationOnServer");},loadBlockConfigurationOnServer:function(i){_4.xhrPost({url:"/rpc/load_prerendered_block_configuration",content:{"i":i},load:_4.hitch(this,this._loadBlockConfigurationOnServerSucceeded)});},loadPrevBlockConfigurationOnServer:function(){if(this.i()>0){this.loadBlockConfigurationOnServer(this.i()-1);}},loadNextBlockConfigurationOnServer:function(){if(this.i()<this._blockConfigurations.length-1){this.loadBlockConfigurationOnServer(this.i()+1);}}});}}};});